<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unticked-promoted-constructors #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.CLI.Shelley.Run.Query</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier">ShelleyQueryCmdError</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#renderShelleyQueryCmdError"><span class="hs-identifier">renderShelleyQueryCmdError</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryCmd"><span class="hs-identifier">runQueryCmd</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">atomically</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson.Encode.Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodePretty</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showEFloat</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except.Extra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">firstExceptT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handleIOExceptT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newExceptT</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">Cardano.Api</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">Cardano.Api.Byron</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">Cardano.Api.LocalChainSync</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">getLocalTip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">Cardano.Api.Protocol</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Environment.html"><span class="hs-identifier">Cardano.CLI.Environment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Environment.html#EnvSocketError"><span class="hs-identifier">EnvSocketError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier">readEnvSocketPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Environment.html#renderEnvSocketError"><span class="hs-identifier">renderEnvSocketError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Helpers.html"><span class="hs-identifier">Cardano.CLI.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Helpers.html#HelpersError"><span class="hs-identifier">HelpersError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Helpers.html#pPrintCBOR"><span class="hs-identifier">pPrintCBOR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Helpers.html#renderHelpersError"><span class="hs-identifier">renderHelpersError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Mary.RenderValue.html"><span class="hs-identifier">Cardano.CLI.Mary.RenderValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Mary.RenderValue.html#defaultRenderValueOptions"><span class="hs-identifier">defaultRenderValueOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Mary.RenderValue.html#renderValue"><span class="hs-identifier">renderValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Shelley.Orphans.html"><span class="hs-identifier">Cardano.CLI.Shelley.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Shelley.Parsers.html"><span class="hs-identifier">Cardano.CLI.Shelley.Parsers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier">OutputFile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryCmd"><span class="hs-identifier">QueryCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.CLI.Types.html"><span class="hs-identifier">Cardano.CLI.Types</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeFull</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Hash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hashToBytesAsHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Consensus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EraMismatch</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>                     </span><span class="annot"><span class="hs-identifier">Query</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Consensus</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.Degenerate</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Consensus</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialised</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getTipPoint</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Core</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Era</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.Constraints</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Address</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.API.Protocol</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Coin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Coin</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Credential</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Delegation.Certificates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IndividualPoolStake</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>                     </span><span class="annot"><span class="hs-identifier">PoolDistr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Keys</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.LedgerState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NewEpochState</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.LedgerState</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.PParams</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PParams</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.Scripts</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.TxBody</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxId</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Shelley.Spec.Ledger.UTxO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTxO</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Consensus</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Protocol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalStateQuery.Type</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LocalStateQuery</span></span><span>
</span><span id="line-79"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AcquireFailure</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="ShelleyQueryCmdError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-var">ShelleyQueryCmdError</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ShelleyQueryCmdEnvVarSocketErr"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.CLI.Environment.html#EnvSocketError"><span class="hs-identifier hs-type">EnvSocketError</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ShelleyQueryCmdLocalStateQueryError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ShelleyQueryCmdWriteFileError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">FileError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ShelleyQueryCmdHelpersError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdHelpersError"><span class="hs-identifier hs-var">ShelleyQueryCmdHelpersError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.CLI.Helpers.html#HelpersError"><span class="hs-identifier hs-type">HelpersError</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679268431"><span id="local-6989586621679268433"><span id="local-6989586621679268435"><span class="annot"><span class="annottext">Int -&gt; ShelleyQueryCmdError -&gt; ShowS
[ShelleyQueryCmdError] -&gt; ShowS
ShelleyQueryCmdError -&gt; String
(Int -&gt; ShelleyQueryCmdError -&gt; ShowS)
-&gt; (ShelleyQueryCmdError -&gt; String)
-&gt; ([ShelleyQueryCmdError] -&gt; ShowS)
-&gt; Show ShelleyQueryCmdError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ShelleyQueryCmdError] -&gt; ShowS
$cshowList :: [ShelleyQueryCmdError] -&gt; ShowS
show :: ShelleyQueryCmdError -&gt; String
$cshow :: ShelleyQueryCmdError -&gt; String
showsPrec :: Int -&gt; ShelleyQueryCmdError -&gt; ShowS
$cshowsPrec :: Int -&gt; ShelleyQueryCmdError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#renderShelleyQueryCmdError"><span class="hs-identifier hs-type">renderShelleyQueryCmdError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-90"></span><span id="renderShelleyQueryCmdError"><span class="annot"><span class="annottext">renderShelleyQueryCmdError :: ShelleyQueryCmdError -&gt; Text
</span><a href="Cardano.CLI.Shelley.Run.Query.html#renderShelleyQueryCmdError"><span class="hs-identifier hs-var hs-var">renderShelleyQueryCmdError</span></a></span></span><span> </span><span id="local-6989586621679268429"><span class="annot"><span class="annottext">ShelleyQueryCmdError
</span><a href="#local-6989586621679268429"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError
</span><a href="#local-6989586621679268429"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-type">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span id="local-6989586621679268428"><span class="annot"><span class="annottext">EnvSocketError
</span><a href="#local-6989586621679268428"><span class="hs-identifier hs-var">envSockErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; Text
</span><a href="Cardano.CLI.Environment.html#renderEnvSocketError"><span class="hs-identifier hs-var">renderEnvSocketError</span></a></span><span> </span><span class="annot"><span class="annottext">EnvSocketError
</span><a href="#local-6989586621679268428"><span class="hs-identifier hs-var">envSockErr</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span id="local-6989586621679268427"><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="#local-6989586621679268427"><span class="hs-identifier hs-var">lsqErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; Text
</span><a href="Cardano.CLI.Shelley.Run.Query.html#renderLocalStateQueryError"><span class="hs-identifier hs-var">renderLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="#local-6989586621679268427"><span class="hs-identifier hs-var">lsqErr</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-type">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span id="local-6989586621679268425"><span class="annot"><span class="annottext">FileError ()
</span><a href="#local-6989586621679268425"><span class="hs-identifier hs-var">fileErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; String
forall e. Error e =&gt; e -&gt; String
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">displayError</span></a></span><span> </span><span class="annot"><span class="annottext">FileError ()
</span><a href="#local-6989586621679268425"><span class="hs-identifier hs-var">fileErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdHelpersError"><span class="hs-identifier hs-type">ShelleyQueryCmdHelpersError</span></a></span><span> </span><span id="local-6989586621679268422"><span class="annot"><span class="annottext">HelpersError
</span><a href="#local-6989586621679268422"><span class="hs-identifier hs-var">helpersErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HelpersError -&gt; Text
</span><a href="Cardano.CLI.Helpers.html#renderHelpersError"><span class="hs-identifier hs-var">renderHelpersError</span></a></span><span> </span><span class="annot"><span class="annottext">HelpersError
</span><a href="#local-6989586621679268422"><span class="hs-identifier hs-var">helpersErr</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryCmd"><span class="hs-identifier hs-type">runQueryCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryCmd"><span class="hs-identifier hs-type">QueryCmd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span id="runQueryCmd"><span class="annot"><span class="annottext">runQueryCmd :: QueryCmd -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryCmd"><span class="hs-identifier hs-var hs-var">runQueryCmd</span></a></span></span><span> </span><span id="local-6989586621679268421"><span class="annot"><span class="annottext">QueryCmd
</span><a href="#local-6989586621679268421"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QueryCmd
</span><a href="#local-6989586621679268421"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryProtocolParameters"><span class="hs-identifier hs-type">QueryProtocolParameters</span></a></span><span> </span><span id="local-6989586621679268419"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268419"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268418"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268418"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268417"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268417"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268416"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268416"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolParameters"><span class="hs-identifier hs-var">runQueryProtocolParameters</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268419"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268418"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268417"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268416"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryTip"><span class="hs-identifier hs-type">QueryTip</span></a></span><span> </span><span id="local-6989586621679268413"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268413"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268412"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268412"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268411"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268411"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryTip"><span class="hs-identifier hs-var">runQueryTip</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268413"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268412"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268411"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryStakeDistribution"><span class="hs-identifier hs-type">QueryStakeDistribution</span></a></span><span> </span><span id="local-6989586621679268408"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268408"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268407"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268407"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268406"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268406"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268405"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268405"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeDistribution"><span class="hs-identifier hs-var">runQueryStakeDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268408"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268407"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268406"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268405"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryStakeAddressInfo"><span class="hs-identifier hs-type">QueryStakeAddressInfo</span></a></span><span> </span><span id="local-6989586621679268402"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268402"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268401"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268401"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268400"><span class="annot"><span class="annottext">StakeAddress
</span><a href="#local-6989586621679268400"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679268399"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268399"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268398"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268398"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; StakeAddress
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeAddressInfo"><span class="hs-identifier hs-var">runQueryStakeAddressInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268402"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268401"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">StakeAddress
</span><a href="#local-6989586621679268400"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268399"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268398"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryLedgerState"><span class="hs-identifier hs-type">QueryLedgerState</span></a></span><span> </span><span id="local-6989586621679268395"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268395"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268394"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268394"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268393"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268393"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268392"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268392"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryLedgerState"><span class="hs-identifier hs-var">runQueryLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268395"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268394"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268393"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268392"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryProtocolState"><span class="hs-identifier hs-type">QueryProtocolState</span></a></span><span> </span><span id="local-6989586621679268389"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268389"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268388"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268388"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268387"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268387"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268386"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268386"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolState"><span class="hs-identifier hs-var">runQueryProtocolState</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268389"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268388"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268387"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268386"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#QueryUTxO"><span class="hs-identifier hs-type">QueryUTxO</span></a></span><span> </span><span id="local-6989586621679268383"><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268383"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268382"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268382"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268381"><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268381"><span class="hs-identifier hs-var">qFilter</span></a></span></span><span> </span><span id="local-6989586621679268380"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268380"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679268379"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268379"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="annottext">AnyCardanoEra
-&gt; Protocol
-&gt; QueryFilter
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryUTxO"><span class="hs-identifier hs-var">runQueryUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">AnyCardanoEra
</span><a href="#local-6989586621679268383"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268382"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268381"><span class="hs-identifier hs-var">qFilter</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268380"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268379"><span class="hs-identifier hs-var">mOutFile</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolParameters"><span class="hs-identifier hs-type">runQueryProtocolParameters</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span id="runQueryProtocolParameters"><span class="annot"><span class="annottext">runQueryProtocolParameters :: AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolParameters"><span class="hs-identifier hs-var hs-var">runQueryProtocolParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268376"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268376"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268375"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268375"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268374"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268374"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268373"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268373"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268371"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268371"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268376"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268368"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268368"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span>
</span><span id="line-125"></span><span>                           </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679268367"><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268367"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (PParams (ShelleyLedgerEra era))
-&gt; ExceptT ShelleyQueryCmdError IO (PParams (ShelleyLedgerEra era))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError
   IO
   (PParams (ShelleyLedgerEra era))
 -&gt; ExceptT
      ShelleyQueryCmdError IO (PParams (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (PParams (ShelleyLedgerEra era))
-&gt; ExceptT ShelleyQueryCmdError IO (PParams (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-127"></span><span>               </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (PParams (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (PParams (ShelleyLedgerEra era))
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268375"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268374"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268368"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError
       IO
       (PParams (ShelleyLedgerEra era)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (PParams (ShelleyLedgerEra era)))
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (PParams (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (PParams (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-128"></span><span>                 </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (PParams (ShelleyLedgerEra era))
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryPParamsFromLocalState"><span class="hs-identifier hs-var">queryPParamsFromLocalState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268371"><span class="hs-identifier hs-var">era'</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
-&gt; PParams (ShelleyLedgerEra era)
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall ledgerera.
Maybe OutputFile
-&gt; PParams ledgerera -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolParameters"><span class="hs-identifier hs-var">writeProtocolParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268373"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268367"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-132"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679268755"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolParameters"><span class="hs-identifier hs-type">writeProtocolParameters</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679268755"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span id="writeProtocolParameters"><span class="annot"><span class="annottext">writeProtocolParameters :: Maybe OutputFile
-&gt; PParams ledgerera -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolParameters"><span class="hs-identifier hs-var hs-var">writeProtocolParameters</span></a></span></span><span> </span><span id="local-6989586621679268361"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268361"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span id="local-6989586621679268360"><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268360"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268361"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams ledgerera -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268360"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268356"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268356"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268356"><span class="hs-identifier hs-var">fpath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268356"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams ledgerera -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268360"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryTip"><span class="hs-identifier hs-type">runQueryTip</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="runQueryTip"><span class="annot"><span class="annottext">runQueryTip :: Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryTip"><span class="hs-identifier hs-var hs-var">runQueryTip</span></a></span></span><span> </span><span id="local-6989586621679268352"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268352"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268351"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268351"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268350"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268350"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268349"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268349"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679268348"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268348"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
-&gt; ExceptT ShelleyQueryCmdError IO ByteString
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
 -&gt; ExceptT ShelleyQueryCmdError IO ByteString)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
-&gt; ExceptT ShelleyQueryCmdError IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268352"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268351"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268349"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString)
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679268347"><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268347"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679268346"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268346"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268347"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679268345"><span class="annot"><span class="annottext">output :: ByteString
</span><a href="#local-6989586621679268345"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268347"><span class="hs-identifier hs-var">connectInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>                       </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268346"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-159"></span><span>                       </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268346"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-160"></span><span>                       </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268346"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">ByteString
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268345"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268350"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268340"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268340"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268340"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268348"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.putStrLn</span></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268348"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryUTxO"><span class="hs-identifier hs-type">runQueryUTxO</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.CLI.Types.html#QueryFilter"><span class="hs-identifier hs-type">QueryFilter</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span id="runQueryUTxO"><span class="annot"><span class="annottext">runQueryUTxO :: AnyCardanoEra
-&gt; Protocol
-&gt; QueryFilter
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryUTxO"><span class="hs-identifier hs-var hs-var">runQueryUTxO</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268339"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268339"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268338"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268338"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268337"><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268337"><span class="hs-identifier hs-var">qfilter</span></a></span></span><span> </span><span id="local-6989586621679268336"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268336"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268335"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268335"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268334"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268334"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268339"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- Obtain the required type equality constaints and class constaints</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ToJSON (Value (ShelleyLedgerEra era)) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era -&gt; (ToJSON (Value ledgerera) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONValue"><span class="hs-identifier hs-var">obtainToJSONValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268334"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">((ToJSON (Value (ShelleyLedgerEra era)) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; (ToJSON (Value (ShelleyLedgerEra era)) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era -&gt; (ShelleyBasedEra ledgerera =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-var">obtainLedgerEraClassConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268334"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; (ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268331"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268331"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679268330"><span class="annot"><span class="annottext">UTxO (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268330"><span class="hs-identifier hs-var">filteredUtxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (UTxO (ShelleyLedgerEra era))
-&gt; ExceptT ShelleyQueryCmdError IO (UTxO (ShelleyLedgerEra era))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError
   IO
   (UTxO (ShelleyLedgerEra era))
 -&gt; ExceptT ShelleyQueryCmdError IO (UTxO (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (UTxO (ShelleyLedgerEra era))
-&gt; ExceptT ShelleyQueryCmdError IO (UTxO (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (UTxO (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (UTxO (ShelleyLedgerEra era))
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268338"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268336"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268331"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError
       IO
       (UTxO (ShelleyLedgerEra era)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (UTxO (ShelleyLedgerEra era)))
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (UTxO (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (UTxO (ShelleyLedgerEra era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; QueryFilter
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (UTxO (ShelleyLedgerEra era))
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera,
 Crypto ledgerera ~ StandardCrypto, IsShelleyBasedEra era) =&gt;
ShelleyBasedEra era
-&gt; QueryFilter
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryUTxOFromLocalState"><span class="hs-identifier hs-var">queryUTxOFromLocalState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268334"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268337"><span class="hs-identifier hs-var">qfilter</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Maybe OutputFile
-&gt; UTxO (ShelleyLedgerEra era)
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera.
(ShelleyBasedEra ledgerera, ShelleyLedgerEra era ~ ledgerera,
 Crypto ledgerera ~ StandardCrypto, ToJSON (Value ledgerera)) =&gt;
ShelleyBasedEra era
-&gt; Maybe OutputFile
-&gt; UTxO ledgerera
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeFilteredUTxOs"><span class="hs-identifier hs-var">writeFilteredUTxOs</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268334"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268335"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268330"><span class="hs-identifier hs-var">filteredUtxo</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-188"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryLedgerState"><span class="hs-identifier hs-type">runQueryLedgerState</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span id="runQueryLedgerState"><span class="annot"><span class="annottext">runQueryLedgerState :: AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryLedgerState"><span class="hs-identifier hs-var hs-var">runQueryLedgerState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268327"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268327"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268326"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268326"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268325"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268325"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268324"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268324"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268323"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268323"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268327"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- Obtain the required class constaints</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era -&gt; (ShelleyBasedEra ledgerera =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-var">obtainLedgerEraClassConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268323"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; (ShelleyBasedEra (ShelleyLedgerEra era) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; (ToJSON (NewEpochState (ShelleyLedgerEra era)) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era -&gt; (ToJSON (NewEpochState ledgerera) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONNewEpochState"><span class="hs-identifier hs-var">obtainToJSONNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268323"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">((ToJSON (NewEpochState (ShelleyLedgerEra era)) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; (ToJSON (NewEpochState (ShelleyLedgerEra era)) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268321"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268321"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679268320"><span class="annot"><span class="annottext">Either ByteString (NewEpochState (ShelleyLedgerEra era))
</span><a href="#local-6989586621679268320"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError
   IO
   (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
 -&gt; ExceptT
      ShelleyQueryCmdError
      IO
      (Either ByteString (NewEpochState (ShelleyLedgerEra era))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
-&gt; ExceptT
     ShelleyQueryCmdError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (Either ByteString (NewEpochState (ShelleyLedgerEra era))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268326"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268325"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268321"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError
       IO
       (Either ByteString (NewEpochState (ShelleyLedgerEra era))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (Either ByteString (NewEpochState (ShelleyLedgerEra era))))
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (Either ByteString (NewEpochState (ShelleyLedgerEra era))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState (ShelleyLedgerEra era)))
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera, ShelleyBased ledgerera) =&gt;
ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalLedgerState"><span class="hs-identifier hs-var">queryLocalLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268323"><span class="hs-identifier hs-var">era'</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ByteString (NewEpochState (ShelleyLedgerEra era))
</span><a href="#local-6989586621679268320"><span class="hs-identifier hs-var">els</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679268318"><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268318"><span class="hs-identifier hs-var">lstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
-&gt; NewEpochState (ShelleyLedgerEra era)
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall ledgerera.
ToJSON (NewEpochState ledgerera) =&gt;
Maybe OutputFile
-&gt; NewEpochState ledgerera -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeLedgerState"><span class="hs-identifier hs-var">writeLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268324"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState (ShelleyLedgerEra era)
</span><a href="#local-6989586621679268318"><span class="hs-identifier hs-var">lstate</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679268316"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268316"><span class="hs-identifier hs-var">lbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">putTextLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Version mismatch between node and consensus, so dumping this as generic CBOR.&quot;</span></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">(HelpersError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">HelpersError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdHelpersError"><span class="hs-identifier hs-var">ShelleyQueryCmdHelpersError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT HelpersError IO ()
</span><a href="Cardano.CLI.Helpers.html#pPrintCBOR"><span class="hs-identifier hs-var">pPrintCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268316"><span class="hs-identifier hs-var">lbs</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-215"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolState"><span class="hs-identifier hs-type">runQueryProtocolState</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span id="runQueryProtocolState"><span class="annot"><span class="annottext">runQueryProtocolState :: AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryProtocolState"><span class="hs-identifier hs-var hs-var">runQueryProtocolState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268314"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268314"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268313"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268313"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268312"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268312"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268311"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268311"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268310"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268310"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268314"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268309"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268309"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679268308"><span class="annot"><span class="annottext">Either ByteString (ChainDepState StandardCrypto)
</span><a href="#local-6989586621679268308"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError
   IO
   (Either ByteString (ChainDepState StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdError
      IO
      (Either ByteString (ChainDepState StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (Either ByteString (ChainDepState StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268313"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268312"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268309"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError
       IO
       (Either ByteString (ChainDepState StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (Either ByteString (ChainDepState StandardCrypto)))
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError
         IO
         (Either ByteString (ChainDepState StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalProtocolState"><span class="hs-identifier hs-var">queryLocalProtocolState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268310"><span class="hs-identifier hs-var">era'</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ByteString (ChainDepState StandardCrypto)
</span><a href="#local-6989586621679268308"><span class="hs-identifier hs-var">els</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679268306"><span class="annot"><span class="annottext">ChainDepState StandardCrypto
</span><a href="#local-6989586621679268306"><span class="hs-identifier hs-var">protocolState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
-&gt; ChainDepState StandardCrypto
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolState"><span class="hs-identifier hs-var">writeProtocolState</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268311"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDepState StandardCrypto
</span><a href="#local-6989586621679268306"><span class="hs-identifier hs-var">protocolState</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679268304"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268304"><span class="hs-identifier hs-var">pbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">putTextLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Version mismatch between node and consensus, so dumping this as generic CBOR.&quot;</span></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">(HelpersError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">HelpersError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdHelpersError"><span class="hs-identifier hs-var">ShelleyQueryCmdHelpersError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT HelpersError IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT HelpersError IO ()
</span><a href="Cardano.CLI.Helpers.html#pPrintCBOR"><span class="hs-identifier hs-var">pPrintCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268304"><span class="hs-identifier hs-var">pbs</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-238"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeAddressInfo"><span class="hs-identifier hs-type">runQueryStakeAddressInfo</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span id="runQueryStakeAddressInfo"><span class="annot"><span class="annottext">runQueryStakeAddressInfo :: AnyCardanoEra
-&gt; Protocol
-&gt; StakeAddress
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeAddressInfo"><span class="hs-identifier hs-var hs-var">runQueryStakeAddressInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268303"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268303"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268302"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268302"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268301"><span class="annot"><span class="annottext">StakeAddress
</span><a href="#local-6989586621679268301"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679268300"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268300"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268299"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268299"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268298"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268298"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268303"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- Obtain the required type equality constaints</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era
-&gt; ((Crypto ledgerera ~ StandardCrypto) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-var">obtainStandardCrypto</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268298"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; ((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268296"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268296"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679268295"><span class="annot"><span class="annottext">DelegationsAndRewards
</span><a href="#local-6989586621679268295"><span class="hs-identifier hs-var">delegsAndRwds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
-&gt; ExceptT ShelleyQueryCmdError IO DelegationsAndRewards
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
 -&gt; ExceptT ShelleyQueryCmdError IO DelegationsAndRewards)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
-&gt; ExceptT ShelleyQueryCmdError IO DelegationsAndRewards
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268302"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268300"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268296"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards)
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards)
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Set StakeAddress
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera,
 Crypto ledgerera ~ StandardCrypto) =&gt;
ShelleyBasedEra era
-&gt; Set StakeAddress
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryDelegationsAndRewardsFromLocalState"><span class="hs-identifier hs-var">queryDelegationsAndRewardsFromLocalState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268298"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StakeAddress -&gt; Set StakeAddress
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">StakeAddress
</span><a href="#local-6989586621679268301"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
-&gt; DelegationsAndRewards -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeAddressInfo"><span class="hs-identifier hs-var">writeStakeAddressInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268299"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">DelegationsAndRewards
</span><a href="#local-6989586621679268295"><span class="hs-identifier hs-var">delegsAndRwds</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-261"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- -------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | An error that can occur while querying a node's local state.</span><span>
</span><span id="line-267"></span><span class="hs-keyword">data</span><span> </span><span id="ShelleyQueryCmdLocalStateQueryError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AcquireFailureError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">LocalStateQuery.AcquireFailure</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EraMismatchError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- ^ A query from a certain era was applied to a ledger from a different</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- era.</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ByronProtocolNotSupportedError"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-comment">-- ^ The query does not support the Byron protocol.</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ShelleyProtocolEraMismatch"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- ^ The Shelley protocol only supports the Shelley era.</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268285"><span id="local-6989586621679268287"><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool
(ShelleyQueryCmdLocalStateQueryError
 -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool)
-&gt; (ShelleyQueryCmdLocalStateQueryError
    -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool)
-&gt; Eq ShelleyQueryCmdLocalStateQueryError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ShelleyQueryCmdLocalStateQueryError
-&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool
$c/= :: ShelleyQueryCmdLocalStateQueryError
-&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool
== :: ShelleyQueryCmdLocalStateQueryError
-&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool
$c== :: ShelleyQueryCmdLocalStateQueryError
-&gt; ShelleyQueryCmdLocalStateQueryError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268278"><span id="local-6989586621679268280"><span id="local-6989586621679268282"><span class="annot"><span class="annottext">Int -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; ShowS
[ShelleyQueryCmdLocalStateQueryError] -&gt; ShowS
ShelleyQueryCmdLocalStateQueryError -&gt; String
(Int -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; ShowS)
-&gt; (ShelleyQueryCmdLocalStateQueryError -&gt; String)
-&gt; ([ShelleyQueryCmdLocalStateQueryError] -&gt; ShowS)
-&gt; Show ShelleyQueryCmdLocalStateQueryError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ShelleyQueryCmdLocalStateQueryError] -&gt; ShowS
$cshowList :: [ShelleyQueryCmdLocalStateQueryError] -&gt; ShowS
show :: ShelleyQueryCmdLocalStateQueryError -&gt; String
$cshow :: ShelleyQueryCmdLocalStateQueryError -&gt; String
showsPrec :: Int -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; ShowS
$cshowsPrec :: Int -&gt; ShelleyQueryCmdLocalStateQueryError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#renderLocalStateQueryError"><span class="hs-identifier hs-type">renderLocalStateQueryError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-279"></span><span id="renderLocalStateQueryError"><span class="annot"><span class="annottext">renderLocalStateQueryError :: ShelleyQueryCmdLocalStateQueryError -&gt; Text
</span><a href="Cardano.CLI.Shelley.Run.Query.html#renderLocalStateQueryError"><span class="hs-identifier hs-var hs-var">renderLocalStateQueryError</span></a></span></span><span> </span><span id="local-6989586621679268277"><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="#local-6989586621679268277"><span class="hs-identifier hs-var">lsqErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="#local-6989586621679268277"><span class="hs-identifier hs-var">lsqErr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-type">AcquireFailureError</span></a></span><span> </span><span id="local-6989586621679268276"><span class="annot"><span class="annottext">AcquireFailure
</span><a href="#local-6989586621679268276"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Local state query acquire failure: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; Text
forall a b. (Show a, ConvertText String b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure
</span><a href="#local-6989586621679268276"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-type">EraMismatchError</span></a></span><span> </span><span id="local-6989586621679268274"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268274"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;A query from a certain era was applied to a ledger from a different era: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EraMismatch -&gt; Text
forall a b. (Show a, ConvertText String b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268274"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;The attempted local state query does not support the Byron protocol.&quot;</span></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;The Shelley protocol mode can only be used with the Shelley era, &quot;</span></span><span>
</span><span id="line-288"></span><span>     </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;i.e. with --shelley-mode use --shelly-era flag&quot;</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeAddressInfo"><span class="hs-identifier hs-type">writeStakeAddressInfo</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span id="writeStakeAddressInfo"><span class="annot"><span class="annottext">writeStakeAddressInfo :: Maybe OutputFile
-&gt; DelegationsAndRewards -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeAddressInfo"><span class="hs-identifier hs-var hs-var">writeStakeAddressInfo</span></a></span></span><span> </span><span id="local-6989586621679268273"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268273"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span id="local-6989586621679268272"><span class="annot"><span class="annottext">dr :: DelegationsAndRewards
</span><a href="#local-6989586621679268272"><span class="hs-identifier hs-var">dr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679268270"><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (Maybe (Hash StakePoolKey), Coin)
</span><a href="#local-6989586621679268270"><span class="hs-identifier hs-var">_delegsAndRwds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268273"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DelegationsAndRewards -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">DelegationsAndRewards
</span><a href="#local-6989586621679268272"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268269"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268269"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268269"><span class="hs-identifier hs-var">fpath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268269"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DelegationsAndRewards -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">DelegationsAndRewards
</span><a href="#local-6989586621679268272"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621679268684"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeLedgerState"><span class="hs-identifier hs-type">writeLedgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewEpochState</span></span><span> </span><span class="annot"><a href="#local-6989586621679268684"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-303"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NewEpochState</span></span><span> </span><span class="annot"><a href="#local-6989586621679268684"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-304"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-305"></span><span id="writeLedgerState"><span class="annot"><span class="annottext">writeLedgerState :: Maybe OutputFile
-&gt; NewEpochState ledgerera -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeLedgerState"><span class="hs-identifier hs-var hs-var">writeLedgerState</span></a></span></span><span> </span><span id="local-6989586621679268268"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268268"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span id="local-6989586621679268267"><span class="annot"><span class="annottext">NewEpochState ledgerera
</span><a href="#local-6989586621679268267"><span class="hs-identifier hs-var">lstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268268"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState ledgerera -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState ledgerera
</span><a href="#local-6989586621679268267"><span class="hs-identifier hs-var">lstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268266"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268266"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268266"><span class="hs-identifier hs-var">fpath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268266"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState ledgerera -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState ledgerera
</span><a href="#local-6989586621679268267"><span class="hs-identifier hs-var">lstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolState"><span class="hs-identifier hs-type">writeProtocolState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-313"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ChainDepState</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-314"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="writeProtocolState"><span class="annot"><span class="annottext">writeProtocolState :: Maybe OutputFile
-&gt; ChainDepState StandardCrypto
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeProtocolState"><span class="hs-identifier hs-var hs-var">writeProtocolState</span></a></span></span><span> </span><span id="local-6989586621679268265"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268265"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span id="local-6989586621679268264"><span class="annot"><span class="annottext">ChainDepState StandardCrypto
</span><a href="#local-6989586621679268264"><span class="hs-identifier hs-var">pstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268265"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDepState StandardCrypto -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">ChainDepState StandardCrypto
</span><a href="#local-6989586621679268264"><span class="hs-identifier hs-var">pstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268263"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268263"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268263"><span class="hs-identifier hs-var">fpath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268263"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDepState StandardCrypto -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">ChainDepState StandardCrypto
</span><a href="#local-6989586621679268264"><span class="hs-identifier hs-var">pstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeFilteredUTxOs"><span class="hs-identifier hs-type">writeFilteredUTxOs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268697"><span class="annot"><a href="#local-6989586621679268697"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268698"><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-323"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Consensus.ShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-324"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268697"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-325"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-326"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268697"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-329"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-330"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679268698"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-331"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span id="writeFilteredUTxOs"><span class="annot"><span class="annottext">writeFilteredUTxOs :: ShelleyBasedEra era
-&gt; Maybe OutputFile
-&gt; UTxO ledgerera
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeFilteredUTxOs"><span class="hs-identifier hs-var hs-var">writeFilteredUTxOs</span></a></span></span><span> </span><span id="local-6989586621679268262"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268262"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268261"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268261"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span> </span><span id="local-6989586621679268260"><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268260"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268261"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; UTxO ledgerera -&gt; IO ()
forall era ledgerera.
(ShelleyBased ledgerera, ShelleyLedgerEra era ~ ledgerera,
 Crypto ledgerera ~ StandardCrypto) =&gt;
ShelleyBasedEra era -&gt; UTxO ledgerera -&gt; IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#printFilteredUTxOs"><span class="hs-identifier hs-var">printFilteredUTxOs</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268262"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268260"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268258"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268258"><span class="hs-identifier hs-var">fpath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268258"><span class="hs-identifier hs-var">fpath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268258"><span class="hs-identifier hs-var">fpath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO ledgerera -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268260"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#printFilteredUTxOs"><span class="hs-identifier hs-type">printFilteredUTxOs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268645"><span class="annot"><a href="#local-6989586621679268645"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268646"><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-339"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ShelleyBased</span></span><span> </span><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-340"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268645"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-341"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-342"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268645"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span id="printFilteredUTxOs"><span class="annot"><span class="annottext">printFilteredUTxOs :: ShelleyBasedEra era -&gt; UTxO ledgerera -&gt; IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#printFilteredUTxOs"><span class="hs-identifier hs-var hs-var">printFilteredUTxOs</span></a></span></span><span> </span><span id="local-6989586621679268257"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268257"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.UTxO</span></span><span> </span><span id="local-6989586621679268255"><span class="annot"><span class="annottext">Map (TxIn (Crypto ledgerera)) (TxOut ledgerera)
</span><a href="#local-6989586621679268255"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">Text.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268253"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a (m :: * -&gt; *). (Print a, MonadIO m) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268253"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">((TxIn StandardCrypto, TxOut ledgerera) -&gt; IO ())
-&gt; [(TxIn StandardCrypto, TxOut ledgerera)] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(TxIn StandardCrypto, TxOut ledgerera) -&gt; IO ()
</span><a href="#local-6989586621679268247"><span class="hs-identifier hs-var">printUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn StandardCrypto, TxOut ledgerera)] -&gt; IO ())
-&gt; [(TxIn StandardCrypto, TxOut ledgerera)] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn StandardCrypto) (TxOut ledgerera)
-&gt; [(TxIn StandardCrypto, TxOut ledgerera)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (Crypto ledgerera)) (TxOut ledgerera)
Map (TxIn StandardCrypto) (TxOut ledgerera)
</span><a href="#local-6989586621679268255"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="#local-6989586621679268253"><span class="hs-identifier hs-type">title</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679268253"><span class="annot"><span class="annottext">title :: Text
</span><a href="#local-6989586621679268253"><span class="hs-identifier hs-var hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;                           TxHash                                 TxIx        Amount&quot;</span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><a href="#local-6989586621679268247"><span class="hs-identifier hs-type">printUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxIn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679268646"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679268247"><span class="annot"><span class="annottext">printUtxo :: (TxIn StandardCrypto, TxOut ledgerera) -&gt; IO ()
</span><a href="#local-6989586621679268247"><span class="hs-identifier hs-var hs-var">printUtxo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxId</span></span><span> </span><span id="local-6989586621679268243"><span class="annot"><span class="annottext">Hash StandardCrypto EraIndependentTxBody
</span><a href="#local-6989586621679268243"><span class="hs-identifier hs-var">txhash</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268242"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679268242"><span class="hs-identifier hs-var">txin</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span> </span><span class="annot"><span class="annottext">Addr (Crypto ledgerera)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679268240"><span class="annot"><span class="annottext">Value ledgerera
</span><a href="#local-6989586621679268240"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">Text.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-357"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">Text.decodeLatin1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash Blake2b_256 EraIndependentTxBody -&gt; ByteString
forall h a. Hash h a -&gt; ByteString
</span><span class="hs-identifier hs-var">hashToBytesAsHex</span></span><span> </span><span class="annot"><span class="annottext">Hash StandardCrypto EraIndependentTxBody
Hash Blake2b_256 EraIndependentTxBody
</span><a href="#local-6989586621679268243"><span class="hs-identifier hs-var">txhash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural -&gt; Text
forall a. Show a =&gt; Int -&gt; a -&gt; Text
</span><a href="#local-6989586621679268238"><span class="hs-identifier hs-var">textShowN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679268242"><span class="hs-identifier hs-var">txin</span></a></span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;        &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Text
</span><a href="#local-6989586621679268237"><span class="hs-identifier hs-var">printableValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; Value ledgerera -&gt; Value
forall era ledgerera.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era -&gt; Value ledgerera -&gt; Value
</span><a href="Cardano.CLI.Shelley.Run.Query.html#convertToApiValue"><span class="hs-identifier hs-var">convertToApiValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268257"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Value ledgerera
</span><a href="#local-6989586621679268240"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679268619"><span class="annot"><a href="#local-6989586621679268238"><span class="hs-identifier hs-type">textShowN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679268619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679268238"><span class="annot"><span class="annottext">textShowN :: Int -&gt; a -&gt; Text
</span><a href="#local-6989586621679268238"><span class="hs-identifier hs-var hs-var">textShowN</span></a></span></span><span> </span><span id="local-6989586621679268235"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679268235"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679268234"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268234"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679268233"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679268233"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a b. (Show a, ConvertText String b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268234"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-365"></span><span>          </span><span id="local-6989586621679268232"><span class="annot"><span class="annottext">slen :: Int
</span><a href="#local-6989586621679268232"><span class="hs-identifier hs-var hs-var">slen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasLength a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268233"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679268235"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679268232"><span class="hs-identifier hs-var">slen</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268233"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="#local-6989586621679268237"><span class="hs-identifier hs-type">printableValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621679268237"><span class="annot"><span class="annottext">printableValue :: Value -&gt; Text
</span><a href="#local-6989586621679268237"><span class="hs-identifier hs-var hs-var">printableValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenderValueOptions -&gt; Value -&gt; Text
</span><a href="Cardano.CLI.Mary.RenderValue.html#renderValue"><span class="hs-identifier hs-var">renderValue</span></a></span><span> </span><span class="annot"><span class="annottext">RenderValueOptions
</span><a href="Cardano.CLI.Mary.RenderValue.html#defaultRenderValueOptions"><span class="hs-identifier hs-var">defaultRenderValueOptions</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeDistribution"><span class="hs-identifier hs-type">runQueryStakeDistribution</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span id="runQueryStakeDistribution"><span class="annot"><span class="annottext">runQueryStakeDistribution :: AnyCardanoEra
-&gt; Protocol
-&gt; NetworkId
-&gt; Maybe OutputFile
-&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#runQueryStakeDistribution"><span class="hs-identifier hs-var hs-var">runQueryStakeDistribution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679268229"><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268229"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268228"><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268228"><span class="hs-identifier hs-var">protocol</span></a></span></span><span> </span><span id="local-6989586621679268227"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268227"><span class="hs-identifier hs-var">network</span></a></span></span><span> </span><span id="local-6989586621679268226"><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268226"><span class="hs-identifier hs-var">mOutFile</span></a></span></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span id="local-6989586621679268225"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268225"><span class="hs-identifier hs-var">era'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; CardanoEraStyle era
forall era. CardanoEra era -&gt; CardanoEraStyle era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">cardanoEraStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><a href="#local-6989586621679268229"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-comment">-- Obtain the required type equality constaints</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; ((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall era ledgerera a.
(ShelleyLedgerEra era ~ ledgerera) =&gt;
ShelleyBasedEra era
-&gt; ((Crypto ledgerera ~ StandardCrypto) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-var">obtainStandardCrypto</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268225"><span class="hs-identifier hs-var">era'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
  ExceptT ShelleyQueryCmdError IO ())
 -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; ((Crypto (ShelleyLedgerEra era) ~ StandardCrypto) =&gt;
    ExceptT ShelleyQueryCmdError IO ())
-&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Cardano.CLI.Types.html#SocketPath"><span class="hs-identifier hs-type">SocketPath</span></a></span><span> </span><span id="local-6989586621679268224"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268224"><span class="hs-identifier hs-var">sockPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(EnvSocketError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT EnvSocketError IO SocketPath
-&gt; ExceptT ShelleyQueryCmdError IO SocketPath
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">EnvSocketError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdEnvVarSocketErr"><span class="hs-identifier hs-var">ShelleyQueryCmdEnvVarSocketErr</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EnvSocketError IO SocketPath
</span><a href="Cardano.CLI.Environment.html#readEnvSocketPath"><span class="hs-identifier hs-var">readEnvSocketPath</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679268223"><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268223"><span class="hs-identifier hs-var">stakeDist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
-&gt; ExceptT ShelleyQueryCmdError IO (PoolDistr StandardCrypto)
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
 -&gt; ExceptT ShelleyQueryCmdError IO (PoolDistr StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
-&gt; ExceptT ShelleyQueryCmdError IO (PoolDistr StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall a.
Protocol
-&gt; NetworkId
-&gt; String
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block -&gt; a)
-&gt; a
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">withlocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679268228"><span class="hs-identifier hs-var">protocol</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268227"><span class="hs-identifier hs-var">network</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268224"><span class="hs-identifier hs-var">sockPath</span></a></span><span> </span><span class="annot"><span class="annottext">((forall mode block.
  RunNode block =&gt;
  LocalNodeConnectInfo mode block
  -&gt; ExceptT
       ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto))
-&gt; (forall mode block.
    RunNode block =&gt;
    LocalNodeConnectInfo mode block
    -&gt; ExceptT
         ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-386"></span><span>          </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall era ledgerera mode block.
(ShelleyLedgerEra era ~ ledgerera,
 Crypto ledgerera ~ StandardCrypto) =&gt;
ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryStakeDistributionFromLocalState"><span class="hs-identifier hs-var">queryStakeDistributionFromLocalState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268225"><span class="hs-identifier hs-var">era'</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputFile
-&gt; PoolDistr StandardCrypto -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeDistribution"><span class="hs-identifier hs-var">writeStakeDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><a href="#local-6989586621679268226"><span class="hs-identifier hs-var">mOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268223"><span class="hs-identifier hs-var">stakeDist</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdError -&gt; ExceptT ShelleyQueryCmdError IO ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-var">ShelleyQueryCmdLocalStateQueryError</span></a></span><span>
</span><span id="line-390"></span><span>                              </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeDistribution"><span class="hs-identifier hs-type">writeStakeDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span>
</span><span id="line-394"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PoolDistr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-395"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdError"><span class="hs-identifier hs-type">ShelleyQueryCmdError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span id="writeStakeDistribution"><span class="annot"><span class="annottext">writeStakeDistribution :: Maybe OutputFile
-&gt; PoolDistr StandardCrypto -&gt; ExceptT ShelleyQueryCmdError IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeDistribution"><span class="hs-identifier hs-var hs-var">writeStakeDistribution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Commands.html#OutputFile"><span class="hs-identifier hs-type">OutputFile</span></a></span><span> </span><span id="local-6989586621679268220"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268220"><span class="hs-identifier hs-var">outFile</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PoolDistr</span></span><span> </span><span id="local-6989586621679268218"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
</span><a href="#local-6989586621679268218"><span class="hs-identifier hs-var">stakeDist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">(IOException -&gt; ShelleyQueryCmdError)
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) x a.
MonadIO m =&gt;
(IOException -&gt; x) -&gt; IO a -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">handleIOExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileError () -&gt; ShelleyQueryCmdError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdWriteFileError"><span class="hs-identifier hs-var">ShelleyQueryCmdWriteFileError</span></a></span><span> </span><span class="annot"><span class="annottext">(FileError () -&gt; ShelleyQueryCmdError)
-&gt; (IOException -&gt; FileError ())
-&gt; IOException
-&gt; ShelleyQueryCmdError
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOException -&gt; FileError ()
forall e. String -&gt; IOException -&gt; FileError e
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">FileIOError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268220"><span class="hs-identifier hs-var">outFile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">LBS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268220"><span class="hs-identifier hs-var">outFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
-&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encodePretty</span></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
</span><a href="#local-6989586621679268218"><span class="hs-identifier hs-var">stakeDist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#writeStakeDistribution"><span class="hs-identifier hs-var">writeStakeDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OutputFile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679268217"><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268217"><span class="hs-identifier hs-var">stakeDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>   </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT ShelleyQueryCmdError IO ())
-&gt; IO () -&gt; ExceptT ShelleyQueryCmdError IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto -&gt; IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#printStakeDistribution"><span class="hs-identifier hs-var">printStakeDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268217"><span class="hs-identifier hs-var">stakeDist</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#printStakeDistribution"><span class="hs-identifier hs-type">printStakeDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PoolDistr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="printStakeDistribution"><span class="annot"><span class="annottext">printStakeDistribution :: PoolDistr StandardCrypto -&gt; IO ()
</span><a href="Cardano.CLI.Shelley.Run.Query.html#printStakeDistribution"><span class="hs-identifier hs-var hs-var">printStakeDistribution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PoolDistr</span></span><span> </span><span id="local-6989586621679268215"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
</span><a href="#local-6989586621679268215"><span class="hs-identifier hs-var">stakeDist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">Text.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268214"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a (m :: * -&gt; *). (Print a, MonadIO m) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268214"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a (m :: * -&gt; *). (Print a, MonadIO m) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hash StakePoolKey -&gt; Rational -&gt; Hash VrfKey -&gt; String
</span><a href="#local-6989586621679268212"><span class="hs-identifier hs-var">showStakeDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto -&gt; Hash StakePoolKey
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">StakePoolKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621679268210"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679268209"><span class="hs-identifier hs-var">stakeFraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash StandardCrypto (VerKeyVRF StandardCrypto) -&gt; Hash VrfKey
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">VrfKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash StandardCrypto (VerKeyVRF StandardCrypto)
</span><a href="#local-6989586621679268207"><span class="hs-identifier hs-var">vrfKeyId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268210"><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto
</span><a href="#local-6989586621679268210"><span class="hs-identifier hs-var">poolId</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IndividualPoolStake</span></span><span> </span><span id="local-6989586621679268209"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679268209"><span class="hs-identifier hs-var">stakeFraction</span></a></span></span><span> </span><span id="local-6989586621679268207"><span class="annot"><span class="annottext">Hash StandardCrypto (VerKeyVRF StandardCrypto)
</span><a href="#local-6989586621679268207"><span class="hs-identifier hs-var">vrfKeyId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
-&gt; [(KeyHash 'StakePool StandardCrypto,
     IndividualPoolStake StandardCrypto)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool StandardCrypto)
  (IndividualPoolStake StandardCrypto)
</span><a href="#local-6989586621679268215"><span class="hs-identifier hs-var">stakeDist</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><a href="#local-6989586621679268214"><span class="hs-identifier hs-type">title</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679268214"><span class="annot"><span class="annottext">title :: Text
</span><a href="#local-6989586621679268214"><span class="hs-identifier hs-var hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;                           PoolId                                 Stake frac&quot;</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><a href="#local-6989586621679268212"><span class="hs-identifier hs-type">showStakeDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">PoolId</span></a></span><span>
</span><span id="line-416"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-417"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">VrfKey</span></a></span><span>
</span><span id="line-418"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679268212"><span class="annot"><span class="annottext">showStakeDistr :: Hash StakePoolKey -&gt; Rational -&gt; Hash VrfKey -&gt; String
</span><a href="#local-6989586621679268212"><span class="hs-identifier hs-var hs-var">showStakeDistr</span></a></span></span><span> </span><span id="local-6989586621679268204"><span class="annot"><span class="annottext">Hash StakePoolKey
</span><a href="#local-6989586621679268204"><span class="hs-identifier hs-var">poolId</span></a></span></span><span> </span><span id="local-6989586621679268203"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679268203"><span class="hs-identifier hs-var">stakeFraction</span></a></span></span><span> </span><span id="local-6989586621679268202"><span class="annot"><span class="annottext">Hash VrfKey
</span><a href="#local-6989586621679268202"><span class="hs-identifier hs-var">_vrfKeyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash StakePoolKey -&gt; Text
forall a. SerialiseAsBech32 a =&gt; a -&gt; Text
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">serialiseToBech32</span></a></span><span> </span><span class="annot"><span class="annottext">Hash StakePoolKey
</span><a href="#local-6989586621679268204"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   &quot;</span></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Double -&gt; ShowS
forall a. RealFloat a =&gt; Maybe Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showEFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679268203"><span class="hs-identifier hs-var">stakeFraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-424"></span><span class="hs-comment">-- TODO: we could show the VRF id, but it will then not fit in 80 cols</span><span>
</span><span id="line-425"></span><span class="hs-comment">--      , show vrfKeyId</span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- From Cardano.Api</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Query the UTxO, filtered by a given set of addresses, from a Shelley node</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- via the local state query protocol.</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- This one is Shelley-specific because the query is Shelley-specific.</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryUTxOFromLocalState"><span class="hs-identifier hs-type">queryUTxOFromLocalState</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268705"><span class="annot"><a href="#local-6989586621679268705"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268704"><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268700"><span class="annot"><a href="#local-6989586621679268700"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268699"><span class="annot"><a href="#local-6989586621679268699"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-438"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268705"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268705"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268705"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.CLI.Types.html#QueryFilter"><span class="hs-identifier hs-type">QueryFilter</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268700"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268699"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span id="queryUTxOFromLocalState"><span class="annot"><span class="annottext">queryUTxOFromLocalState :: ShelleyBasedEra era
-&gt; QueryFilter
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryUTxOFromLocalState"><span class="hs-identifier hs-var hs-var">queryUTxOFromLocalState</span></a></span></span><span> </span><span id="local-6989586621679268198"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268198"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268197"><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268197"><span class="hs-identifier hs-var">qFilter</span></a></span></span><span>
</span><span id="line-446"></span><span>                        </span><span id="local-6989586621679268196"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268196"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-447"></span><span>                          </span><span id="local-6989586621679268194"><span class="annot"><span class="annottext">NodeConsensusMode mode block
localNodeConsensusMode :: NodeConsensusMode mode block
localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="#local-6989586621679268194"><span class="hs-identifier hs-var hs-var">localNodeConsensusMode</span></a></span></span><span>
</span><span id="line-448"></span><span>                        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeConsensusMode mode block
</span><a href="#local-6989586621679268194"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268198"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>      </span><span id="local-6989586621679268192"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268192"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268196"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268190"><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268190"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (UTxO ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO ledgerera))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-456"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (UTxO StandardShelley)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268196"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-458"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268192"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-459"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (UTxO ledgerera)
-&gt; Query
     (HardForkBlock '[ShelleyBlock ledgerera])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (UTxO StandardShelley))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryFilter -&gt; Query (ShelleyBlock ledgerera) (UTxO ledgerera)
</span><a href="#local-6989586621679268187"><span class="hs-identifier hs-var">applyUTxOFilter</span></a></span><span> </span><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268197"><span class="hs-identifier hs-var">qFilter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">UTxO ledgerera
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268190"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621679268186"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268186"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268196"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621679268185"><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (UTxO ledgerera)
</span><a href="#local-6989586621679268185"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (UTxO ledgerera))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (UTxO ledgerera))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult StandardCrypto (UTxO ledgerera))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (UTxO ledgerera))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (UTxO ledgerera))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (UTxO ledgerera))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-468"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query block (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (UTxO ledgerera)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-469"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268196"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-470"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268186"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) (UTxO ledgerera)
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto (UTxO ledgerera))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268198"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryFilter -&gt; Query (ShelleyBlock ledgerera) (UTxO ledgerera)
</span><a href="#local-6989586621679268187"><span class="hs-identifier hs-var">applyUTxOFilter</span></a></span><span> </span><span class="annot"><span class="annottext">QueryFilter
</span><a href="#local-6989586621679268197"><span class="hs-identifier hs-var">qFilter</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (UTxO ledgerera)
</span><a href="#local-6989586621679268185"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268182"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268182"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268182"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span> </span><span id="local-6989586621679268180"><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268180"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxO ledgerera
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (UTxO ledgerera)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UTxO ledgerera
</span><a href="#local-6989586621679268180"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="#local-6989586621679268187"><span class="hs-identifier hs-type">applyUTxOFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.CLI.Types.html#QueryFilter"><span class="hs-identifier hs-type">QueryFilter</span></a></span><span>
</span><span id="line-476"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Consensus.ShelleyBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679268704"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679268187"><span class="annot"><span class="annottext">applyUTxOFilter :: QueryFilter -&gt; Query (ShelleyBlock ledgerera) (UTxO ledgerera)
</span><a href="#local-6989586621679268187"><span class="hs-identifier hs-var hs-var">applyUTxOFilter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Types.html#FilterByAddress"><span class="hs-identifier hs-type">FilterByAddress</span></a></span><span> </span><span id="local-6989586621679268178"><span class="annot"><span class="annottext">Set AddressAny
</span><a href="#local-6989586621679268178"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Addr (EraCrypto ledgerera))
-&gt; Query (ShelleyBlock ledgerera) (UTxO ledgerera)
forall era.
Set (Addr (EraCrypto era)) -&gt; Query (ShelleyBlock era) (UTxO era)
</span><span class="hs-identifier hs-var">Consensus.GetFilteredUTxO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set AddressAny -&gt; Set (Addr StandardCrypto)
</span><a href="#local-6989586621679268176"><span class="hs-identifier hs-var">toShelleyAddrs</span></a></span><span> </span><span class="annot"><span class="annottext">Set AddressAny
</span><a href="#local-6989586621679268178"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621679268187"><span class="hs-identifier hs-var">applyUTxOFilter</span></a></span><span> </span><span class="annot"><span class="annottext">QueryFilter
</span><a href="Cardano.CLI.Types.html#NoFilter"><span class="hs-identifier hs-var">NoFilter</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (UTxO ledgerera)
forall era. Query (ShelleyBlock era) (UTxO era)
</span><span class="hs-identifier hs-var">Consensus.GetUTxO</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><a href="#local-6989586621679268176"><span class="hs-identifier hs-type">toShelleyAddrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AddressAny</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Addr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679268176"><span class="annot"><span class="annottext">toShelleyAddrs :: Set AddressAny -&gt; Set (Addr StandardCrypto)
</span><a href="#local-6989586621679268176"><span class="hs-identifier hs-var hs-var">toShelleyAddrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AddressAny -&gt; Addr StandardCrypto)
-&gt; Set AddressAny -&gt; Set (Addr StandardCrypto)
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressInEra era -&gt; Addr StandardCrypto
forall era. AddressInEra era -&gt; Addr StandardCrypto
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">toShelleyAddr</span></a></span><span>
</span><span id="line-483"></span><span>                           </span><span class="annot"><span class="annottext">(AddressInEra era -&gt; Addr StandardCrypto)
-&gt; (AddressAny -&gt; AddressInEra era)
-&gt; AddressAny
-&gt; Addr StandardCrypto
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressAny -&gt; AddressInEra era
forall era. IsShelleyBasedEra era =&gt; AddressAny -&gt; AddressInEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">anyAddressInShelleyBasedEra</span></a></span><span>
</span><span id="line-484"></span><span>                                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AddressAny</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">AddressInEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268705"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- | A mapping of Shelley reward accounts to both the stake pool that they</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- delegate to and their reward account balance.</span><span>
</span><span id="line-488"></span><span class="hs-keyword">data</span><span> </span><span id="DelegationsAndRewards"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-var">DelegationsAndRewards</span></a></span></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DelegationsAndRewards"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-var">DelegationsAndRewards</span></a></span></span><span>
</span><span id="line-490"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">NetworkId</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Credential</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Staking</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakePoolKey</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679268164"><span id="local-6989586621679268166"><span id="local-6989586621679268168"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-495"></span><span>  </span><span id="local-6989586621679268162"><span class="annot"><span class="annottext">toJSON :: DelegationsAndRewards -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span><span> </span><span id="local-6989586621679268160"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268160"><span class="hs-identifier hs-var">nw</span></a></span></span><span> </span><span id="local-6989586621679268159"><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (Maybe (Hash StakePoolKey), Coin)
</span><a href="#local-6989586621679268159"><span class="hs-identifier hs-var">delegsAndRwds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>      </span><span class="annot"><span class="annottext">Array -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.Array</span></span><span> </span><span class="annot"><span class="annottext">(Array -&gt; Value)
-&gt; ([(Credential 'Staking StandardCrypto,
      (Maybe (Hash StakePoolKey), Coin))]
    -&gt; Array)
-&gt; [(Credential 'Staking StandardCrypto,
     (Maybe (Hash StakePoolKey), Coin))]
-&gt; Value
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Array
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.fromList</span></span><span>
</span><span id="line-497"></span><span>        </span><span class="annot"><span class="annottext">([Value] -&gt; Array)
-&gt; ([(Credential 'Staking StandardCrypto,
      (Maybe (Hash StakePoolKey), Coin))]
    -&gt; [Value])
-&gt; [(Credential 'Staking StandardCrypto,
     (Maybe (Hash StakePoolKey), Coin))]
-&gt; Array
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Credential 'Staking StandardCrypto,
  (Maybe (Hash StakePoolKey), Coin))
 -&gt; Value)
-&gt; [(Credential 'Staking StandardCrypto,
     (Maybe (Hash StakePoolKey), Coin))]
-&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking StandardCrypto,
 (Maybe (Hash StakePoolKey), Coin))
-&gt; Value
</span><a href="#local-6989586621679268155"><span class="hs-identifier hs-var">delegAndRwdToJson</span></a></span><span> </span><span class="annot"><span class="annottext">([(Credential 'Staking StandardCrypto,
   (Maybe (Hash StakePoolKey), Coin))]
 -&gt; Value)
-&gt; [(Credential 'Staking StandardCrypto,
     (Maybe (Hash StakePoolKey), Coin))]
-&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (Maybe (Hash StakePoolKey), Coin)
-&gt; [(Credential 'Staking StandardCrypto,
     (Maybe (Hash StakePoolKey), Coin))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (Maybe (Hash StakePoolKey), Coin)
</span><a href="#local-6989586621679268159"><span class="hs-identifier hs-var">delegsAndRwds</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><a href="#local-6989586621679268155"><span class="hs-identifier hs-type">delegAndRwdToJson</span></a></span><span>
</span><span id="line-500"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Credential</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Staking</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakePoolKey</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span>
</span><span id="line-502"></span><span>      </span><span id="local-6989586621679268155"><span class="annot"><span class="annottext">delegAndRwdToJson :: (Credential 'Staking StandardCrypto,
 (Maybe (Hash StakePoolKey), Coin))
-&gt; Value
</span><a href="#local-6989586621679268155"><span class="hs-identifier hs-var hs-var">delegAndRwdToJson</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268154"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268154"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268153"><span class="annot"><span class="annottext">Maybe (Hash StakePoolKey)
</span><a href="#local-6989586621679268153"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268152"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679268152"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-504"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;address&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto -&gt; Text
</span><a href="#local-6989586621679268150"><span class="hs-identifier hs-var">renderAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268154"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-505"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;delegation&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Hash StakePoolKey) -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Hash StakePoolKey)
</span><a href="#local-6989586621679268153"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-506"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;rewardAccountBalance&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Coin -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679268152"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span>      </span><span class="annot"><a href="#local-6989586621679268150"><span class="hs-identifier hs-type">renderAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Credential</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Staking</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-510"></span><span>      </span><span id="local-6989586621679268150"><span class="annot"><span class="annottext">renderAddress :: Credential 'Staking StandardCrypto -&gt; Text
</span><a href="#local-6989586621679268150"><span class="hs-identifier hs-var hs-var">renderAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StakeAddress -&gt; Text
forall addr. SerialiseAddress addr =&gt; addr -&gt; Text
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">serialiseAddress</span></a></span><span>
</span><span id="line-511"></span><span>                    </span><span class="annot"><span class="annottext">(StakeAddress -&gt; Text)
-&gt; (Credential 'Staking StandardCrypto -&gt; StakeAddress)
-&gt; Credential 'Staking StandardCrypto
-&gt; Text
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Credential 'Staking StandardCrypto -&gt; StakeAddress
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">StakeAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; Network
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">toShelleyNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268160"><span class="hs-identifier hs-var">nw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>                    </span><span class="annot"><span class="annottext">(Credential 'Staking StandardCrypto -&gt; StakeAddress)
-&gt; (Credential 'Staking StandardCrypto
    -&gt; Credential 'Staking StandardCrypto)
-&gt; Credential 'Staking StandardCrypto
-&gt; StakeAddress
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential -&gt; Credential 'Staking StandardCrypto
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">toShelleyStakeCredential</span></a></span><span>
</span><span id="line-513"></span><span>                    </span><span class="annot"><span class="annottext">(StakeCredential -&gt; Credential 'Staking StandardCrypto)
-&gt; (Credential 'Staking StandardCrypto -&gt; StakeCredential)
-&gt; Credential 'Staking StandardCrypto
-&gt; Credential 'Staking StandardCrypto
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto -&gt; StakeCredential
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">fromShelleyStakeCredential</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Query the current protocol parameters from a Shelley node via the local</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- state query protocol.</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- This one is Shelley-specific because the query is Shelley-specific.</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryPParamsFromLocalState"><span class="hs-identifier hs-type">queryPParamsFromLocalState</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268759"><span class="annot"><a href="#local-6989586621679268759"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268758"><span class="annot"><a href="#local-6989586621679268758"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268757"><span class="annot"><a href="#local-6989586621679268757"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268756"><span class="annot"><a href="#local-6989586621679268756"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-523"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268759"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268758"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268759"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268757"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268756"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679268758"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span id="queryPParamsFromLocalState"><span class="annot"><span class="annottext">queryPParamsFromLocalState :: ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryPParamsFromLocalState"><span class="hs-identifier hs-var hs-var">queryPParamsFromLocalState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-528"></span><span>                               </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-529"></span><span>                             </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryPParamsFromLocalState"><span class="hs-identifier hs-var">queryPParamsFromLocalState</span></a></span><span> </span><span id="local-6989586621679268144"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268144"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268143"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268143"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-533"></span><span>                                 </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyMode</span></a></span><span>
</span><span id="line-534"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268144"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679268142"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268142"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268143"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268141"><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268141"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley] (PParams StandardShelley))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PParams ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams ledgerera))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PParams StandardShelley)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-540"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268143"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-541"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268142"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-542"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (PParams StandardShelley)
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PParams StandardShelley))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (PParams StandardShelley)
forall era. Query (ShelleyBlock era) (PParams' Identity era)
</span><span class="hs-identifier hs-var">Consensus.GetCurrentPParams</span></span><span>
</span><span id="line-543"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">PParams ledgerera
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268141"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryPParamsFromLocalState"><span class="hs-identifier hs-var">queryPParamsFromLocalState</span></a></span><span> </span><span id="local-6989586621679268139"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268139"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268138"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268138"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-549"></span><span>                                 </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-550"></span><span>                               </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621679268137"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268137"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268138"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679268136"><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (PParams ledgerera)
</span><a href="#local-6989586621679268136"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult StandardCrypto (PParams ledgerera))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult StandardCrypto (PParams ledgerera)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult StandardCrypto (PParams ledgerera)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block (CardanoQueryResult StandardCrypto (PParams ledgerera)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PParams ledgerera)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-554"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268138"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268137"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) (PParams ledgerera)
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult StandardCrypto (PParams ledgerera))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268139"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock (ShelleyLedgerEra era)) (PParams ledgerera)
forall era. Query (ShelleyBlock era) (PParams' Identity era)
</span><span class="hs-identifier hs-var">Consensus.GetCurrentPParams</span></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (PParams ledgerera)
</span><a href="#local-6989586621679268136"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268135"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268135"><span class="hs-identifier hs-var">eraerr</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268135"><span class="hs-identifier hs-var">eraerr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span>     </span><span id="local-6989586621679268134"><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268134"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PParams ledgerera
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PParams ledgerera)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PParams ledgerera
</span><a href="#local-6989586621679268134"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- | Query the current stake distribution from a Shelley node via the local</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- state query protocol.</span><span>
</span><span id="line-563"></span><span class="hs-comment">--</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- This one is Shelley-specific because the query is Shelley-specific.</span><span>
</span><span id="line-565"></span><span class="hs-comment">--</span><span>
</span><span id="line-566"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryStakeDistributionFromLocalState"><span class="hs-identifier hs-type">queryStakeDistributionFromLocalState</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268605"><span class="annot"><a href="#local-6989586621679268605"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268604"><span class="annot"><a href="#local-6989586621679268604"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268603"><span class="annot"><a href="#local-6989586621679268603"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268602"><span class="annot"><a href="#local-6989586621679268602"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-568"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268605"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268604"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268604"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268605"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268603"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268602"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PoolDistr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span id="queryStakeDistributionFromLocalState"><span class="annot"><span class="annottext">queryStakeDistributionFromLocalState :: ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryStakeDistributionFromLocalState"><span class="hs-identifier hs-var hs-var">queryStakeDistributionFromLocalState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-574"></span><span>                                         </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-575"></span><span>                                       </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryStakeDistributionFromLocalState"><span class="hs-identifier hs-var">queryStakeDistributionFromLocalState</span></a></span><span> </span><span id="local-6989586621679268133"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268133"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268132"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268132"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-579"></span><span>                                           </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-580"></span><span>                                         </span><span class="hs-special">}</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268133"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679268131"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268131"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268132"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268130"><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268130"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-585"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268132"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-587"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268131"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-588"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (PoolDistr StandardCrypto)
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley] (PoolDistr StandardCrypto))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (PoolDistr StandardCrypto)
forall era. Query (ShelleyBlock era) (PoolDistr (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.GetStakeDistribution</span></span><span>
</span><span id="line-589"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268130"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryStakeDistributionFromLocalState"><span class="hs-identifier hs-var">queryStakeDistributionFromLocalState</span></a></span><span> </span><span id="local-6989586621679268128"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268128"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268127"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268127"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-595"></span><span>                                           </span><span class="annot"><span class="annottext">localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-596"></span><span>                                         </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679268126"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268126"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268127"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-598"></span><span>  </span><span id="local-6989586621679268125"><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)
</span><a href="#local-6989586621679268125"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268127"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268126"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query
     (ShelleyBlock (ShelleyLedgerEra era)) (PoolDistr StandardCrypto)
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268128"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock (ShelleyLedgerEra era)) (PoolDistr StandardCrypto)
forall era. Query (ShelleyBlock era) (PoolDistr (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.GetStakeDistribution</span></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult StandardCrypto (PoolDistr StandardCrypto)
</span><a href="#local-6989586621679268125"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268124"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268124"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268124"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span> </span><span id="local-6989586621679268123"><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268123"><span class="hs-identifier hs-var">stakeDist</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO (PoolDistr StandardCrypto)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PoolDistr StandardCrypto
</span><a href="#local-6989586621679268123"><span class="hs-identifier hs-var">stakeDist</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalLedgerState"><span class="hs-identifier hs-type">queryLocalLedgerState</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268689"><span class="annot"><a href="#local-6989586621679268689"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268688"><span class="annot"><a href="#local-6989586621679268688"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268686"><span class="annot"><a href="#local-6989586621679268686"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268685"><span class="annot"><a href="#local-6989586621679268685"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-608"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268689"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268688"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ShelleyBased</span></span><span> </span><span class="annot"><a href="#local-6989586621679268688"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268689"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268686"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268685"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-613"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewEpochState</span></span><span> </span><span class="annot"><a href="#local-6989586621679268688"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span id="queryLocalLedgerState"><span class="annot"><span class="annottext">queryLocalLedgerState :: ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalLedgerState"><span class="hs-identifier hs-var hs-var">queryLocalLedgerState</span></a></span></span><span> </span><span id="local-6989586621679268121"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268121"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268120"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268120"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679268119"><span class="annot"><span class="annottext">NodeConsensusMode mode block
localNodeConsensusMode :: NodeConsensusMode mode block
localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="#local-6989586621679268119"><span class="hs-identifier hs-var hs-var">localNodeConsensusMode</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeConsensusMode mode block
</span><a href="#local-6989586621679268119"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268121"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>      </span><span id="local-6989586621679268118"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268118"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268120"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-620"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268117"><span class="annot"><span class="annottext">Serialised (NewEpochState StandardShelley)
</span><a href="#local-6989586621679268117"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-621"></span><span>        </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley]
      (Serialised (NewEpochState StandardShelley)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (NewEpochState StandardShelley))))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Serialised (NewEpochState StandardShelley))))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Serialised (NewEpochState StandardShelley))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (NewEpochState StandardShelley))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley))))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (NewEpochState StandardShelley))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (NewEpochState StandardShelley))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (NewEpochState StandardShelley))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-622"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (NewEpochState StandardShelley))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (NewEpochState StandardShelley))))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-623"></span><span>            </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268120"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-624"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268118"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-625"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock StandardShelley)
  (Serialised (NewEpochState StandardShelley))
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="annot"><span class="annottext">(Query
   (ShelleyBlock StandardShelley)
   (Serialised (NewEpochState StandardShelley))
 -&gt; Query
      (HardForkBlock '[ShelleyBlock StandardShelley])
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (NewEpochState StandardShelley))))
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Serialised (NewEpochState StandardShelley))
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (NewEpochState StandardShelley)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-626"></span><span>                </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock StandardShelley) (NewEpochState StandardShelley)
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Serialised (NewEpochState StandardShelley))
forall era result.
Query (ShelleyBlock era) result
-&gt; Query (ShelleyBlock era) (Serialised result)
</span><span class="hs-identifier hs-var">Consensus.GetCBOR</span></span><span> </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock StandardShelley) (NewEpochState StandardShelley)
forall era. Query (ShelleyBlock era) (NewEpochState era)
</span><span class="hs-identifier hs-var">Consensus.DebugNewEpochState</span></span><span>
</span><span id="line-627"></span><span>                </span><span class="hs-comment">-- Get CBOR-in-CBOR version</span><span>
</span><span id="line-628"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>      </span><span class="annot"><span class="annottext">Either ByteString (NewEpochState ledgerera)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Serialised (NewEpochState StandardShelley)
-&gt; Either ByteString (NewEpochState ledgerera)
forall c a. FromCBOR c =&gt; Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268114"><span class="hs-identifier hs-var">decodeLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">Serialised (NewEpochState StandardShelley)
</span><a href="#local-6989586621679268117"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-634"></span><span>      </span><span id="local-6989586621679268113"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268113"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268120"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-635"></span><span>      </span><span id="local-6989586621679268112"><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto (Serialised (NewEpochState ledgerera))
</span><a href="#local-6989586621679268112"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult
      StandardCrypto (Serialised (NewEpochState ledgerera)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult
            StandardCrypto (Serialised (NewEpochState ledgerera))))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult
            StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult
         StandardCrypto (Serialised (NewEpochState ledgerera))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-636"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (CardanoQueryResult
         StandardCrypto (Serialised (NewEpochState ledgerera))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (NewEpochState ledgerera))))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-637"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268120"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268113"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-639"></span><span>           </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query
     (ShelleyBlock (ShelleyLedgerEra era))
     (Serialised (NewEpochState ledgerera))
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult
        StandardCrypto (Serialised (NewEpochState ledgerera)))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268121"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (NewEpochState ledgerera)
-&gt; Query
     (ShelleyBlock ledgerera) (Serialised (NewEpochState ledgerera))
forall era result.
Query (ShelleyBlock era) result
-&gt; Query (ShelleyBlock era) (Serialised result)
</span><span class="hs-identifier hs-var">Consensus.GetCBOR</span></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (NewEpochState ledgerera)
forall era. Query (ShelleyBlock era) (NewEpochState era)
</span><span class="hs-identifier hs-var">Consensus.DebugNewEpochState</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>           </span><span class="hs-comment">-- Get CBOR-in-CBOR version</span><span>
</span><span id="line-641"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto (Serialised (NewEpochState ledgerera))
</span><a href="#local-6989586621679268112"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-642"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268111"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268111"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268111"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span> </span><span id="local-6989586621679268110"><span class="annot"><span class="annottext">Serialised (NewEpochState ledgerera)
</span><a href="#local-6989586621679268110"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either ByteString (NewEpochState ledgerera)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (NewEpochState ledgerera))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Serialised (NewEpochState ledgerera)
-&gt; Either ByteString (NewEpochState ledgerera)
forall c a. FromCBOR c =&gt; Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268114"><span class="hs-identifier hs-var">decodeLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">Serialised (NewEpochState ledgerera)
</span><a href="#local-6989586621679268110"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-comment">-- If decode as a LedgerState fails we return the ByteString so we can do a generic</span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-comment">-- CBOR decode.</span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679268114"><span class="annot"><span class="annottext">decodeLedgerState :: Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268114"><span class="hs-identifier hs-var hs-var">decodeLedgerState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Serialised</span></span><span> </span><span id="local-6989586621679268108"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268108"><span class="hs-identifier hs-var">lbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><span class="annottext">(DecoderError -&gt; ByteString)
-&gt; Either DecoderError c -&gt; Either ByteString c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; DecoderError -&gt; ByteString
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268108"><span class="hs-identifier hs-var">lbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either DecoderError c
forall a. FromCBOR a =&gt; ByteString -&gt; Either DecoderError a
</span><span class="hs-identifier hs-var">decodeFull</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268108"><span class="hs-identifier hs-var">lbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalProtocolState"><span class="hs-identifier hs-type">queryLocalProtocolState</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268679"><span class="annot"><a href="#local-6989586621679268679"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268678"><span class="annot"><a href="#local-6989586621679268678"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268677"><span class="annot"><a href="#local-6989586621679268677"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268676"><span class="annot"><a href="#local-6989586621679268676"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-652"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268679"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268678"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268679"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268677"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268676"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-656"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.ChainDepState</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span id="queryLocalProtocolState"><span class="annot"><span class="annottext">queryLocalProtocolState :: ShelleyBasedEra era
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryLocalProtocolState"><span class="hs-identifier hs-var hs-var">queryLocalProtocolState</span></a></span></span><span> </span><span id="local-6989586621679268105"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268105"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268104"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268104"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679268103"><span class="annot"><span class="annottext">NodeConsensusMode mode block
localNodeConsensusMode :: NodeConsensusMode mode block
localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="#local-6989586621679268103"><span class="hs-identifier hs-var hs-var">localNodeConsensusMode</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeConsensusMode mode block
</span><a href="#local-6989586621679268103"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268105"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-662"></span><span>      </span><span id="local-6989586621679268102"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268102"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268104"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-663"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268101"><span class="annot"><span class="annottext">Serialised (ChainDepState StandardCrypto)
</span><a href="#local-6989586621679268101"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley]
      (Serialised (ChainDepState StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (ChainDepState StandardCrypto))))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Serialised (ChainDepState StandardCrypto))))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Serialised (ChainDepState StandardCrypto))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (ChainDepState StandardCrypto))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto))))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (ChainDepState StandardCrypto))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (ChainDepState StandardCrypto))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (ChainDepState StandardCrypto))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-665"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (ChainDepState StandardCrypto))))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Serialised (ChainDepState StandardCrypto))))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-666"></span><span>            </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268104"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-667"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268102"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-668"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock StandardShelley)
  (Serialised (ChainDepState StandardCrypto))
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="annot"><span class="annottext">(Query
   (ShelleyBlock StandardShelley)
   (Serialised (ChainDepState StandardCrypto))
 -&gt; Query
      (HardForkBlock '[ShelleyBlock StandardShelley])
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Serialised (ChainDepState StandardCrypto))))
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Serialised (ChainDepState StandardCrypto))
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Serialised (ChainDepState StandardCrypto)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-669"></span><span>                </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (ChainDepState StandardCrypto)
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Serialised (ChainDepState StandardCrypto))
forall era result.
Query (ShelleyBlock era) result
-&gt; Query (ShelleyBlock era) (Serialised result)
</span><span class="hs-identifier hs-var">Consensus.GetCBOR</span></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock StandardShelley) (ChainDepState StandardCrypto)
forall era.
Query (ShelleyBlock era) (ChainDepState (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.DebugChainDepState</span></span><span>
</span><span id="line-670"></span><span>                </span><span class="hs-comment">-- Get CBOR-in-CBOR version</span><span>
</span><span id="line-671"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>      </span><span class="annot"><span class="annottext">Either ByteString (ChainDepState StandardCrypto)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Serialised (ChainDepState StandardCrypto)
-&gt; Either ByteString (ChainDepState StandardCrypto)
forall c a. FromCBOR c =&gt; Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268099"><span class="hs-identifier hs-var">decodeProtocolState</span></a></span><span> </span><span class="annot"><span class="annottext">Serialised (ChainDepState StandardCrypto)
</span><a href="#local-6989586621679268101"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-677"></span><span>      </span><span id="local-6989586621679268098"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268098"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268104"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-678"></span><span>      </span><span id="local-6989586621679268097"><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))
</span><a href="#local-6989586621679268097"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult
      StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult
            StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult
            StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult
         StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-679"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (CardanoQueryResult
         StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-680"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268104"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268098"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-682"></span><span>           </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query
     (ShelleyBlock (ShelleyLedgerEra era))
     (Serialised (ChainDepState (Crypto ledgerera)))
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult
        StandardCrypto (Serialised (ChainDepState (Crypto ledgerera))))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268105"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (ChainDepState (Crypto ledgerera))
-&gt; Query
     (ShelleyBlock ledgerera)
     (Serialised (ChainDepState (Crypto ledgerera)))
forall era result.
Query (ShelleyBlock era) result
-&gt; Query (ShelleyBlock era) (Serialised result)
</span><span class="hs-identifier hs-var">Consensus.GetCBOR</span></span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock ledgerera) (ChainDepState (Crypto ledgerera))
forall era.
Query (ShelleyBlock era) (ChainDepState (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.DebugChainDepState</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>                                  </span><span class="hs-comment">-- Get CBOR-in-CBOR version</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto (Serialised (ChainDepState (Crypto ledgerera)))
</span><a href="#local-6989586621679268097"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268096"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268096"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268096"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span> </span><span id="local-6989586621679268095"><span class="annot"><span class="annottext">Serialised (ChainDepState (Crypto ledgerera))
</span><a href="#local-6989586621679268095"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either ByteString (ChainDepState StandardCrypto)
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (Either ByteString (ChainDepState StandardCrypto))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Serialised (ChainDepState (Crypto ledgerera))
-&gt; Either ByteString (ChainDepState StandardCrypto)
forall c a. FromCBOR c =&gt; Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268099"><span class="hs-identifier hs-var">decodeProtocolState</span></a></span><span> </span><span class="annot"><span class="annottext">Serialised (ChainDepState (Crypto ledgerera))
</span><a href="#local-6989586621679268095"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-comment">-- If decode as a ChainDepState fails we return the ByteString so we can do a generic</span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-comment">-- CBOR decode.</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679268099"><span class="annot"><span class="annottext">decodeProtocolState :: Serialised a -&gt; Either ByteString c
</span><a href="#local-6989586621679268099"><span class="hs-identifier hs-var hs-var">decodeProtocolState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Serialised</span></span><span> </span><span id="local-6989586621679268094"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268094"><span class="hs-identifier hs-var">pbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-691"></span><span>      </span><span class="annot"><span class="annottext">(DecoderError -&gt; ByteString)
-&gt; Either DecoderError c -&gt; Either ByteString c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; DecoderError -&gt; ByteString
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268094"><span class="hs-identifier hs-var">pbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either DecoderError c
forall a. FromCBOR a =&gt; ByteString -&gt; Either DecoderError a
</span><span class="hs-identifier hs-var">decodeFull</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679268094"><span class="hs-identifier hs-var">pbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">-- | Query the current delegations and reward accounts, filtered by a given</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- set of addresses, from a Shelley node via the local state query protocol.</span><span>
</span><span id="line-696"></span><span class="hs-comment">--</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- This one is Shelley-specific because the query is Shelley-specific.</span><span>
</span><span id="line-698"></span><span class="hs-comment">--</span><span>
</span><span id="line-699"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryDelegationsAndRewardsFromLocalState"><span class="hs-identifier hs-type">queryDelegationsAndRewardsFromLocalState</span></a></span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679268667"><span class="annot"><a href="#local-6989586621679268667"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679268666"><span class="annot"><a href="#local-6989586621679268666"><span class="hs-identifier hs-type">ledgerera</span></a></span></span><span> </span><span id="local-6989586621679268665"><span class="annot"><a href="#local-6989586621679268665"><span class="hs-identifier hs-type">mode</span></a></span></span><span> </span><span id="local-6989586621679268664"><span class="annot"><a href="#local-6989586621679268664"><span class="hs-identifier hs-type">block</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-701"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268667"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268666"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268666"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268667"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268665"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268664"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyQueryCmdLocalStateQueryError"><span class="hs-identifier hs-type">ShelleyQueryCmdLocalStateQueryError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-707"></span><span>             </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span><span>
</span><span id="line-708"></span><span id="queryDelegationsAndRewardsFromLocalState"><span class="annot"><span class="annottext">queryDelegationsAndRewardsFromLocalState :: ShelleyBasedEra era
-&gt; Set StakeAddress
-&gt; LocalNodeConnectInfo mode block
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryDelegationsAndRewardsFromLocalState"><span class="hs-identifier hs-var hs-var">queryDelegationsAndRewardsFromLocalState</span></a></span></span><span> </span><span id="local-6989586621679268093"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268093"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679268092"><span class="annot"><span class="annottext">Set StakeAddress
</span><a href="#local-6989586621679268092"><span class="hs-identifier hs-var">stakeaddrs</span></a></span></span><span>
</span><span id="line-709"></span><span>                                         </span><span id="local-6989586621679268091"><span class="annot"><span class="annottext">connectInfo :: LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268091"><span class="hs-identifier hs-var">connectInfo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-710"></span><span>                                           </span><span id="local-6989586621679268090"><span class="annot"><span class="annottext">NetworkId
localNodeNetworkId :: forall mode block. LocalNodeConnectInfo mode block -&gt; NetworkId
localNodeNetworkId :: NetworkId
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var hs-var">localNodeNetworkId</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-711"></span><span>                                           </span><span id="local-6989586621679268088"><span class="annot"><span class="annottext">NodeConsensusMode mode block
localNodeConsensusMode :: NodeConsensusMode mode block
localNodeConsensusMode :: forall mode block.
LocalNodeConnectInfo mode block -&gt; NodeConsensusMode mode block
</span><a href="#local-6989586621679268088"><span class="hs-identifier hs-var hs-var">localNodeConsensusMode</span></a></span></span><span>
</span><span id="line-712"></span><span>                                         </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeConsensusMode mode block
</span><a href="#local-6989586621679268088"><span class="hs-identifier hs-var">localNodeConsensusMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-714"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ByronMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ByronProtocolNotSupportedError"><span class="hs-identifier hs-var">ByronProtocolNotSupportedError</span></a></span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268093"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-717"></span><span>      </span><span id="local-6989586621679268087"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268087"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268091"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-718"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Consensus.DegenQueryResult</span></span><span> </span><span id="local-6989586621679268086"><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto),
 RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268086"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (HardForkQueryResult
      '[ShelleyBlock StandardShelley]
      (Map
         (Credential 'Staking StandardCrypto)
         (KeyHash 'StakePool StandardCrypto),
       RewardAccounts StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; (IO
      (Either
         AcquireFailure
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Map
               (Credential 'Staking StandardCrypto)
               (KeyHash 'StakePool StandardCrypto),
             RewardAccounts StandardCrypto)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (HardForkQueryResult
            '[ShelleyBlock StandardShelley]
            (Map
               (Credential 'Staking StandardCrypto)
               (KeyHash 'StakePool StandardCrypto),
             RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto)))
-&gt; ExceptT
     AcquireFailure
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-720"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (HardForkQueryResult
           '[ShelleyBlock StandardShelley]
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-721"></span><span>            </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268091"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-722"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268087"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-723"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Query
  (ShelleyBlock StandardShelley)
  (Map
     (Credential 'Staking StandardCrypto)
     (KeyHash 'StakePool StandardCrypto),
   RewardAccounts StandardCrypto)
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall b a result.
(HardForkQueryResult '[b] result ~ a) =&gt;
Query b result -&gt; Query (HardForkBlock '[b]) a
</span><span class="hs-identifier hs-var">Consensus.DegenQuery</span></span><span> </span><span class="annot"><span class="annottext">(Query
   (ShelleyBlock StandardShelley)
   (Map
      (Credential 'Staking StandardCrypto)
      (KeyHash 'StakePool StandardCrypto),
    RewardAccounts StandardCrypto)
 -&gt; Query
      (HardForkBlock '[ShelleyBlock StandardShelley])
      (HardForkQueryResult
         '[ShelleyBlock StandardShelley]
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Map
        (Credential 'Staking StandardCrypto)
        (KeyHash 'StakePool StandardCrypto),
      RewardAccounts StandardCrypto)
-&gt; Query
     (HardForkBlock '[ShelleyBlock StandardShelley])
     (HardForkQueryResult
        '[ShelleyBlock StandardShelley]
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-724"></span><span>                </span><span class="annot"><span class="annottext">Set (Credential 'Staking (EraCrypto StandardShelley))
-&gt; Query
     (ShelleyBlock StandardShelley)
     (Delegations (EraCrypto StandardShelley),
      RewardAccounts (EraCrypto StandardShelley))
forall era.
Set (Credential 'Staking (EraCrypto era))
-&gt; Query
     (ShelleyBlock era)
     (Delegations (EraCrypto era), RewardAccounts (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.GetFilteredDelegationsAndRewardAccounts</span></span><span>
</span><span id="line-725"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set StakeAddress -&gt; Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621679268084"><span class="hs-identifier hs-var">toShelleyStakeCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">Set StakeAddress
</span><a href="#local-6989586621679268092"><span class="hs-identifier hs-var">stakeaddrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>      </span><span class="annot"><span class="annottext">DelegationsAndRewards
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto)
 -&gt; RewardAccounts StandardCrypto -&gt; DelegationsAndRewards)
-&gt; (Map
      (Credential 'Staking StandardCrypto)
      (KeyHash 'StakePool StandardCrypto),
    RewardAccounts StandardCrypto)
-&gt; DelegationsAndRewards
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (KeyHash 'StakePool StandardCrypto)
-&gt; RewardAccounts StandardCrypto -&gt; DelegationsAndRewards
</span><a href="#local-6989586621679268082"><span class="hs-identifier hs-var">toDelegsAndRwds</span></a></span><span> </span><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto),
 RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268086"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#ShelleyProtocolEraMismatch"><span class="hs-identifier hs-var">ShelleyProtocolEraMismatch</span></a></span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">CardanoMode</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-732"></span><span>      </span><span id="local-6989586621679268081"><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268081"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Tip block)
 -&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block))
-&gt; IO (Tip block)
-&gt; ExceptT ShelleyQueryCmdLocalStateQueryError IO (Tip block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block -&gt; IO (Tip block)
forall block mode.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block -&gt; IO (Tip block)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">getLocalTip</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268091"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-733"></span><span>      </span><span id="local-6989586621679268080"><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto
  (Map
     (Credential 'Staking StandardCrypto)
     (KeyHash 'StakePool StandardCrypto),
   RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268080"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError)
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall (m :: * -&gt; *) x y a.
Functor m =&gt;
(x -&gt; y) -&gt; ExceptT x m a -&gt; ExceptT y m a
</span><span class="hs-identifier hs-var">firstExceptT</span></span><span> </span><span class="annot"><span class="annottext">AcquireFailure -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#AcquireFailureError"><span class="hs-identifier hs-var">AcquireFailureError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   AcquireFailure
   IO
   (CardanoQueryResult
      StandardCrypto
      (Map
         (Credential 'Staking StandardCrypto)
         (KeyHash 'StakePool StandardCrypto),
       RewardAccounts StandardCrypto))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; (IO
      (Either
         AcquireFailure
         (CardanoQueryResult
            StandardCrypto
            (Map
               (Credential 'Staking StandardCrypto)
               (KeyHash 'StakePool StandardCrypto),
             RewardAccounts StandardCrypto)))
    -&gt; ExceptT
         AcquireFailure
         IO
         (CardanoQueryResult
            StandardCrypto
            (Map
               (Credential 'Staking StandardCrypto)
               (KeyHash 'StakePool StandardCrypto),
             RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     AcquireFailure
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto)))
-&gt; ExceptT
     AcquireFailure
     IO
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall (m :: * -&gt; *) x a. m (Either x a) -&gt; ExceptT x m a
</span><span class="hs-identifier hs-var">newExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Either
      AcquireFailure
      (CardanoQueryResult
         StandardCrypto
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError
      IO
      (CardanoQueryResult
         StandardCrypto
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError
     IO
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-734"></span><span>        </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
-&gt; (Point block,
    Query
      block
      (CardanoQueryResult
         StandardCrypto
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; IO
     (Either
        AcquireFailure
        (CardanoQueryResult
           StandardCrypto
           (Map
              (Credential 'Staking StandardCrypto)
              (KeyHash 'StakePool StandardCrypto),
            RewardAccounts StandardCrypto)))
forall mode block result.
(ShowProxy block, ShowProxy (ApplyTxErr block),
 ShowProxy (Query block), ShowProxy (GenTx block),
 ShowQuery (Query block)) =&gt;
LocalNodeConnectInfo mode block
-&gt; (Point block, Query block result)
-&gt; IO (Either AcquireFailure result)
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">queryNodeLocalState</span></a></span><span>
</span><span id="line-735"></span><span>          </span><span class="annot"><span class="annottext">LocalNodeConnectInfo mode block
</span><a href="#local-6989586621679268091"><span class="hs-identifier hs-var">connectInfo</span></a></span><span>
</span><span id="line-736"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Tip block -&gt; Point block
forall b. Tip b -&gt; Point b
</span><span class="hs-identifier hs-var">getTipPoint</span></span><span> </span><span class="annot"><span class="annottext">Tip block
</span><a href="#local-6989586621679268081"><span class="hs-identifier hs-var">tip</span></a></span><span>
</span><span id="line-737"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; Query
     (ShelleyBlock (ShelleyLedgerEra era))
     (Map
        (Credential 'Staking StandardCrypto)
        (KeyHash 'StakePool StandardCrypto),
      RewardAccounts StandardCrypto)
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall era result.
ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679268093"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">(Query
   (ShelleyBlock (ShelleyLedgerEra era))
   (Map
      (Credential 'Staking StandardCrypto)
      (KeyHash 'StakePool StandardCrypto),
    RewardAccounts StandardCrypto)
 -&gt; CardanoQuery
      StandardCrypto
      (CardanoQueryResult
         StandardCrypto
         (Map
            (Credential 'Staking StandardCrypto)
            (KeyHash 'StakePool StandardCrypto),
          RewardAccounts StandardCrypto)))
-&gt; Query
     (ShelleyBlock (ShelleyLedgerEra era))
     (Map
        (Credential 'Staking StandardCrypto)
        (KeyHash 'StakePool StandardCrypto),
      RewardAccounts StandardCrypto)
-&gt; CardanoQuery
     StandardCrypto
     (CardanoQueryResult
        StandardCrypto
        (Map
           (Credential 'Staking StandardCrypto)
           (KeyHash 'StakePool StandardCrypto),
         RewardAccounts StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-738"></span><span>              </span><span class="annot"><span class="annottext">Set (Credential 'Staking (EraCrypto ledgerera))
-&gt; Query
     (ShelleyBlock ledgerera)
     (Delegations (EraCrypto ledgerera),
      RewardAccounts (EraCrypto ledgerera))
forall era.
Set (Credential 'Staking (EraCrypto era))
-&gt; Query
     (ShelleyBlock era)
     (Delegations (EraCrypto era), RewardAccounts (EraCrypto era))
</span><span class="hs-identifier hs-var">Consensus.GetFilteredDelegationsAndRewardAccounts</span></span><span>
</span><span id="line-739"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set StakeAddress -&gt; Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621679268084"><span class="hs-identifier hs-var">toShelleyStakeCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">Set StakeAddress
</span><a href="#local-6989586621679268092"><span class="hs-identifier hs-var">stakeaddrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoQueryResult
  StandardCrypto
  (Map
     (Credential 'Staking StandardCrypto)
     (KeyHash 'StakePool StandardCrypto),
   RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268080"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-742"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultEraMismatch</span></span><span> </span><span id="local-6989586621679268079"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268079"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShelleyQueryCmdLocalStateQueryError
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; ShelleyQueryCmdLocalStateQueryError
</span><a href="Cardano.CLI.Shelley.Run.Query.html#EraMismatchError"><span class="hs-identifier hs-var">EraMismatchError</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679268079"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">QueryResultSuccess</span></span><span> </span><span id="local-6989586621679268078"><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto),
 RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268078"><span class="hs-identifier hs-var">drs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DelegationsAndRewards
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DelegationsAndRewards
 -&gt; ExceptT
      ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards)
-&gt; DelegationsAndRewards
-&gt; ExceptT
     ShelleyQueryCmdLocalStateQueryError IO DelegationsAndRewards
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto)
 -&gt; RewardAccounts StandardCrypto -&gt; DelegationsAndRewards)
-&gt; (Map
      (Credential 'Staking StandardCrypto)
      (KeyHash 'StakePool StandardCrypto),
    RewardAccounts StandardCrypto)
-&gt; DelegationsAndRewards
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (KeyHash 'StakePool StandardCrypto)
-&gt; RewardAccounts StandardCrypto -&gt; DelegationsAndRewards
</span><a href="#local-6989586621679268082"><span class="hs-identifier hs-var">toDelegsAndRwds</span></a></span><span> </span><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (KeyHash 'StakePool StandardCrypto),
 RewardAccounts StandardCrypto)
</span><a href="#local-6989586621679268078"><span class="hs-identifier hs-var">drs</span></a></span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><a href="#local-6989586621679268082"><span class="hs-identifier hs-type">toDelegsAndRwds</span></a></span><span>
</span><span id="line-746"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Credential</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Staking</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.KeyHash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.StakePool</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.RewardAccounts</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-749"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-type">DelegationsAndRewards</span></a></span><span>
</span><span id="line-750"></span><span>    </span><span id="local-6989586621679268082"><span class="annot"><span class="annottext">toDelegsAndRwds :: Map
  (Credential 'Staking StandardCrypto)
  (KeyHash 'StakePool StandardCrypto)
-&gt; RewardAccounts StandardCrypto -&gt; DelegationsAndRewards
</span><a href="#local-6989586621679268082"><span class="hs-identifier hs-var hs-var">toDelegsAndRwds</span></a></span></span><span> </span><span id="local-6989586621679268077"><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621679268077"><span class="hs-identifier hs-var">delegs</span></a></span></span><span> </span><span id="local-6989586621679268076"><span class="annot"><span class="annottext">RewardAccounts StandardCrypto
</span><a href="#local-6989586621679268076"><span class="hs-identifier hs-var">rwdAcnts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-751"></span><span>      </span><span class="annot"><span class="annottext">NetworkId
-&gt; Map
     (Credential 'Staking StandardCrypto)
     (Maybe (Hash StakePoolKey), Coin)
-&gt; DelegationsAndRewards
</span><a href="Cardano.CLI.Shelley.Run.Query.html#DelegationsAndRewards"><span class="hs-identifier hs-var">DelegationsAndRewards</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679268090"><span class="hs-identifier hs-var">localNodeNetworkId</span></a></span><span> </span><span class="annot"><span class="annottext">(Map
   (Credential 'Staking StandardCrypto)
   (Maybe (Hash StakePoolKey), Coin)
 -&gt; DelegationsAndRewards)
-&gt; Map
     (Credential 'Staking StandardCrypto)
     (Maybe (Hash StakePoolKey), Coin)
-&gt; DelegationsAndRewards
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">(Credential 'Staking StandardCrypto
 -&gt; Coin -&gt; (Maybe (Hash StakePoolKey), Coin))
-&gt; RewardAccounts StandardCrypto
-&gt; Map
     (Credential 'Staking StandardCrypto)
     (Maybe (Hash StakePoolKey), Coin)
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span>
</span><span id="line-753"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679268074"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268074"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679268073"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679268073"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool StandardCrypto -&gt; Hash StakePoolKey
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">StakePoolKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool StandardCrypto -&gt; Hash StakePoolKey)
-&gt; Maybe (KeyHash 'StakePool StandardCrypto)
-&gt; Maybe (Hash StakePoolKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
-&gt; Map
     (Credential 'Staking StandardCrypto)
     (KeyHash 'StakePool StandardCrypto)
-&gt; Maybe (KeyHash 'StakePool StandardCrypto)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268074"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (Credential 'Staking StandardCrypto)
  (KeyHash 'StakePool StandardCrypto)
</span><a href="#local-6989586621679268077"><span class="hs-identifier hs-var">delegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679268073"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>          </span><span class="annot"><span class="annottext">RewardAccounts StandardCrypto
</span><a href="#local-6989586621679268076"><span class="hs-identifier hs-var">rwdAcnts</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="#local-6989586621679268084"><span class="hs-identifier hs-type">toShelleyStakeCredentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span>
</span><span id="line-757"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.StakeCredential</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621679268084"><span class="annot"><span class="annottext">toShelleyStakeCredentials :: Set StakeAddress -&gt; Set (Credential 'Staking StandardCrypto)
</span><a href="#local-6989586621679268084"><span class="hs-identifier hs-var hs-var">toShelleyStakeCredentials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-759"></span><span>      </span><span class="annot"><span class="annottext">(StakeAddress -&gt; Credential 'Staking StandardCrypto)
-&gt; Set StakeAddress -&gt; Set (Credential 'Staking StandardCrypto)
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StakeCredential -&gt; Credential 'Staking StandardCrypto
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">toShelleyStakeCredential</span></a></span><span>
</span><span id="line-760"></span><span>             </span><span class="annot"><span class="annottext">(StakeCredential -&gt; Credential 'Staking StandardCrypto)
-&gt; (StakeAddress -&gt; StakeCredential)
-&gt; StakeAddress
-&gt; Credential 'Staking StandardCrypto
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto -&gt; StakeCredential
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">fromShelleyStakeCredential</span></a></span><span>
</span><span id="line-761"></span><span>             </span><span class="annot"><span class="annottext">(Credential 'Staking StandardCrypto -&gt; StakeCredential)
-&gt; (StakeAddress -&gt; Credential 'Staking StandardCrypto)
-&gt; StakeAddress
-&gt; StakeCredential
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679268069"><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268069"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking StandardCrypto
</span><a href="#local-6989586621679268069"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- Era-generic helper functions</span><span>
</span><span id="line-766"></span><span class="hs-comment">--</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="hs-comment">-- | Select the appropriate query constructor based on the era</span><span>
</span><span id="line-769"></span><span class="hs-comment">-- 'QueryIfCurrentShelley', 'QueryIfCurrentAllegra' or 'QueryIfCurrentMary'.</span><span>
</span><span id="line-770"></span><span class="hs-comment">--</span><span>
</span><span id="line-771"></span><span class="hs-comment">--</span><span>
</span><span id="line-772"></span><span id="local-6989586621679268564"><span id="local-6989586621679268565"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-type">queryIfCurrentEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268565"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-773"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Consensus.ShelleyBlock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268565"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679268564"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-774"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Consensus.CardanoQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-775"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Consensus.CardanoQueryResult</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268564"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-776"></span><span id="queryIfCurrentEra"><span class="annot"><span class="annottext">queryIfCurrentEra :: ShelleyBasedEra era
-&gt; Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
</span><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var hs-var">queryIfCurrentEra</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
forall c a result.
(CardanoQueryResult c result ~ a) =&gt;
Query (ShelleyBlock (ShelleyEra c)) result -&gt; CardanoQuery c a
</span><span class="hs-identifier hs-var">Consensus.QueryIfCurrentShelley</span></span><span>
</span><span id="line-777"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
forall c a result.
(CardanoQueryResult c result ~ a) =&gt;
Query (ShelleyBlock (AllegraEra c)) result -&gt; CardanoQuery c a
</span><span class="hs-identifier hs-var">Consensus.QueryIfCurrentAllegra</span></span><span>
</span><span id="line-778"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#queryIfCurrentEra"><span class="hs-identifier hs-var">queryIfCurrentEra</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (ShelleyBlock (ShelleyLedgerEra era)) result
-&gt; CardanoQuery
     StandardCrypto (CardanoQueryResult StandardCrypto result)
forall c a result.
(CardanoQueryResult c result ~ a) =&gt;
Query (ShelleyBlock (MaryEra c)) result -&gt; CardanoQuery c a
</span><span class="hs-identifier hs-var">Consensus.QueryIfCurrentMary</span></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span id="local-6989586621679268709"><span id="local-6989586621679268710"><span id="local-6989586621679268711"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-type">obtainLedgerEraClassConstraints</span></a></span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268711"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268710"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268711"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Consensus.ShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679268710"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268709"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-784"></span><span id="obtainLedgerEraClassConstraints"><span class="annot"><span class="annottext">obtainLedgerEraClassConstraints :: ShelleyBasedEra era -&gt; (ShelleyBasedEra ledgerera =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-var hs-var">obtainLedgerEraClassConstraints</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span id="local-6989586621679268063"><span class="annot"><span class="annottext">ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268063"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268063"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-785"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-var">obtainLedgerEraClassConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span id="local-6989586621679268062"><span class="annot"><span class="annottext">ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268062"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268062"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-786"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainLedgerEraClassConstraints"><span class="hs-identifier hs-var">obtainLedgerEraClassConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span>    </span><span id="local-6989586621679268061"><span class="annot"><span class="annottext">ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268061"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ShelleyBasedEra ledgerera =&gt; a
</span><a href="#local-6989586621679268061"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span id="local-6989586621679268692"><span id="local-6989586621679268693"><span id="local-6989586621679268694"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONNewEpochState"><span class="hs-identifier hs-type">obtainToJSONNewEpochState</span></a></span><span>
</span><span id="line-789"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268694"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268693"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268694"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewEpochState</span></span><span> </span><span class="annot"><a href="#local-6989586621679268693"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268692"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268692"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-792"></span><span id="obtainToJSONNewEpochState"><span class="annot"><span class="annottext">obtainToJSONNewEpochState :: ShelleyBasedEra era -&gt; (ToJSON (NewEpochState ledgerera) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONNewEpochState"><span class="hs-identifier hs-var hs-var">obtainToJSONNewEpochState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span id="local-6989586621679268060"><span class="annot"><span class="annottext">ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268060"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268060"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-793"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONNewEpochState"><span class="hs-identifier hs-var">obtainToJSONNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span id="local-6989586621679268059"><span class="annot"><span class="annottext">ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268059"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268059"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-794"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONNewEpochState"><span class="hs-identifier hs-var">obtainToJSONNewEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span>    </span><span id="local-6989586621679268058"><span class="annot"><span class="annottext">ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268058"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (NewEpochState ledgerera) =&gt; a
</span><a href="#local-6989586621679268058"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span id="local-6989586621679268672"><span id="local-6989586621679268673"><span id="local-6989586621679268674"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-type">obtainStandardCrypto</span></a></span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268674"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268673"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268674"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Crypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679268673"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268672"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268672"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-800"></span><span id="obtainStandardCrypto"><span class="annot"><span class="annottext">obtainStandardCrypto :: ShelleyBasedEra era
-&gt; ((Crypto ledgerera ~ StandardCrypto) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-var hs-var">obtainStandardCrypto</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span id="local-6989586621679268057"><span class="annot"><span class="annottext">(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268057"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-801"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-var">obtainStandardCrypto</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span id="local-6989586621679268056"><span class="annot"><span class="annottext">(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268056"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268056"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-802"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainStandardCrypto"><span class="hs-identifier hs-var">obtainStandardCrypto</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span>    </span><span id="local-6989586621679268055"><span class="annot"><span class="annottext">(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268055"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
(Crypto ledgerera ~ StandardCrypto) =&gt; a
</span><a href="#local-6989586621679268055"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span id="local-6989586621679268713"><span id="local-6989586621679268714"><span id="local-6989586621679268715"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONValue"><span class="hs-identifier hs-type">obtainToJSONValue</span></a></span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268715"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268714"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-806"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268715"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679268714"><span class="hs-identifier hs-type">ledgerera</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268713"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-808"></span><span id="obtainToJSONValue"><span class="annot"><span class="annottext">obtainToJSONValue :: ShelleyBasedEra era -&gt; (ToJSON (Value ledgerera) =&gt; a) -&gt; a
</span><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONValue"><span class="hs-identifier hs-var hs-var">obtainToJSONValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span id="local-6989586621679268054"><span class="annot"><span class="annottext">ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268054"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268054"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-809"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONValue"><span class="hs-identifier hs-var">obtainToJSONValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span id="local-6989586621679268053"><span class="annot"><span class="annottext">ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268053"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268053"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-810"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#obtainToJSONValue"><span class="hs-identifier hs-var">obtainToJSONValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span>    </span><span id="local-6989586621679268052"><span class="annot"><span class="annottext">ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268052"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
ToJSON (Value ledgerera) =&gt; a
</span><a href="#local-6989586621679268052"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="hs-comment">-- | Convert a ledger 'Ledger.Value' to a @cardano-api@ 'Value'.</span><span>
</span><span id="line-813"></span><span id="local-6989586621679268616"><span id="local-6989586621679268617"><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#convertToApiValue"><span class="hs-identifier hs-type">convertToApiValue</span></a></span><span>
</span><span id="line-814"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268617"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679268616"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">ShelleyBasedEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268617"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-816"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679268616"><span class="hs-identifier hs-type">ledgerera</span></a></span><span>
</span><span id="line-817"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-type">Value</span></a></span></span></span><span>
</span><span id="line-818"></span><span id="convertToApiValue"><span class="annot"><span class="annottext">convertToApiValue :: ShelleyBasedEra era -&gt; Value ledgerera -&gt; Value
</span><a href="Cardano.CLI.Shelley.Run.Query.html#convertToApiValue"><span class="hs-identifier hs-var hs-var">convertToApiValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">lovelaceToValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; (Coin -&gt; Lovelace) -&gt; Coin -&gt; Value
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Lovelace
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">fromShelleyLovelace</span></a></span><span>
</span><span id="line-819"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#convertToApiValue"><span class="hs-identifier hs-var">convertToApiValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraAllegra</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">lovelaceToValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; (Coin -&gt; Lovelace) -&gt; Coin -&gt; Value
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Lovelace
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">fromShelleyLovelace</span></a></span><span>
</span><span id="line-820"></span><span class="annot"><a href="Cardano.CLI.Shelley.Run.Query.html#convertToApiValue"><span class="hs-identifier hs-var">convertToApiValue</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">ShelleyBasedEraMary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value ledgerera -&gt; Value
Value StandardCrypto -&gt; Value
</span><a href="../file:///home/runner/work/cardano-node/cardano-node/dist/build/x86_64-linux/ghc-8.10.2/cardano-api-1.24.2/noopt/doc/html/cardano-api/src"><span class="hs-identifier hs-var">fromMaryValue</span></a></span><span>
</span><span id="line-821"></span></pre></body></html>